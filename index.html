<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÂÆá‰∏úÁ∫∫ÁªáÊä•‰ª∑Á≥ªÁªü - Cloudflare R2‰∫ëÁ´ØÁâà</title>
    
    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    
    <!-- Element Plus -->
    <link rel="stylesheet" href="https://unpkg.com/element-plus/dist/index.css">
    <script src="https://unpkg.com/element-plus/dist/index.full.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- AWS SDK (ÂÖºÂÆπCloudflare R2) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aws-sdk/2.1462.0/aws-sdk.min.js"></script>
    
    <!-- ÂÖ∂‰ªñÂøÖË¶ÅÂ∫ì -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <style>
        /* Ëá™ÂÆö‰πâÊ†∑Âºè */
        .gradient-bg {
            background: linear-gradient(135deg, #52D1B2 0%, #40A891 100%);
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(8px);
        }
        
        .tab-button {
            transition: all 0.3s ease;
        }
        
        .tab-button.active {
            background: linear-gradient(135deg, #52D1B2 0%, #40A891 100%);
            color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .product-card {
            transition: all 0.3s ease;
        }
        
        .product-card:hover {
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }
        
        .image-preview {
            transition: all 0.3s ease;
        }
        
        .image-preview:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        /* Êñ∞Â¢ûÊ†∑Âºè */
        .header-section {
            padding-bottom: 2rem;
        }
        
        .main-content {
            margin-top: 2rem;
        }
        
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }
        
        .button-group button {
            flex: 1 1 auto;
            min-width: 120px;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
        }
        
        .data-backup-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }
        
        @media (min-width: 768px) {
            .data-backup-grid {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        /* ‰øÆÂ§çÊ†áÁ≠æÈ°µÁÇπÂáªÈóÆÈ¢ò */
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div id="app"></div>

    <script>
        // Á°Æ‰øùVueÂíåElement PlusÂä†ËΩΩÂÆåÊàê
        document.addEventListener('DOMContentLoaded', function() {
            const { createApp, ref, reactive, computed, onMounted, watch, nextTick } = Vue;
            const { ElMessage, ElMessageBox, ElLoading } = ElementPlus;
            
            const app = createApp({
                setup() {
                    // ÂìçÂ∫îÂºèÊï∞ÊçÆ
                    const loading = ref(true);
                    const activeTab = ref('query');
                    const searchInput = ref('');
                    const searchHistory = ref([]);
                    const catalogData = ref({});
                    const searchResults = ref([]);
                    const fuzzyMatches = ref([]);
                    const rangeResults = ref([]);
                    const manageSearchTerm = ref('');
                    const manageCurrentPage = ref(1);
                    const managePageSize = ref(20);
                    const filteredManageProducts = ref([]);
                    const hasMoreProducts = ref(false);
                    const editingProduct = ref(null);
                    const productForm = reactive({
                        code: '',
                        price: '',
                        priceAlt: '',
                        width: '',
                        composition: '',
                        weight: '',
                        notes: '',
                        supplier: '',
                        imageFile: null
                    });
                    const r2Config = reactive({
                        accountId: '',
                        accessKey: '',
                        secretKey: '',
                        bucket: '',
                        customDomain: 'https://img.yudong-textile.top'
                    });
                    const s3Client = ref(null);
                    const imageModalVisible = ref(false);
                    const currentImage = ref('');
                    const backupFiles = ref([]);
                    const operationMessage = ref({ text: '', type: '' });
                    
                    // ËÆ°ÁÆóÂ±ûÊÄß
                    const stats = computed(() => {
                        const totalProducts = Object.keys(catalogData.value).length;
                        let r2Images = 0;
                        let localImages = 0;
                        let missingImages = 0;
                        
                        Object.values(catalogData.value).forEach(product => {
                            if (product.image) {
                                if (product.image.includes(r2Config.customDomain) || 
                                    product.image.includes('.r2.cloudflarestorage.com')) {
                                    r2Images++;
                                } else if (product.image.startsWith('data:image')) {
                                    localImages++;
                                } else {
                                    r2Images++;
                                }
                            } else {
                                missingImages++;
                            }
                        });
                        
                        const estimatedSize = estimateDataSize();
                        const healthScore = calculateHealthScore(totalProducts, r2Images, missingImages);
                        
                        return {
                            totalProducts,
                            r2Images,
                            localImages,
                            missingImages,
                            storageUsage: formatBytes(estimatedSize, 1),
                            systemHealth: healthScore
                        };
                    });
                    
                    const storageStatus = computed(() => {
                        const dataSize = estimateDataSize();
                        const warningThreshold = 10 * 1024 * 1024;
                        const criticalThreshold = 30 * 1024 * 1024;
                        
                        if (dataSize > criticalThreshold) {
                            return {
                                type: 'error',
                                message: `‚ö†Ô∏è Â≠òÂÇ®Á©∫Èó¥Á¥ßÂº† (${formatBytes(dataSize)}) - Âª∫ËÆÆÁ´ãÂç≥ËøÅÁßªÂà∞Cloudflare R2`
                            };
                        } else if (dataSize > warningThreshold) {
                            return {
                                type: 'warning',
                                message: `üíæ Â≠òÂÇ®‰ΩøÁî®ÈáèËæÉÈ´ò (${formatBytes(dataSize)}) - Âª∫ËÆÆÈÖçÁΩÆCloudflare R2`
                            };
                        } else {
                            return null;
                        }
                    });
                    
                    // Â∑•ÂÖ∑ÂáΩÊï∞
                    const estimateDataSize = () => {
                        let size = 0;
                        
                        const dataStr = JSON.stringify(catalogData.value);
                        size += new Blob([dataStr]).size;
                        
                        Object.values(catalogData.value).forEach(product => {
                            if (product.image && product.image.startsWith('data:image')) {
                                size += product.image.length * 3 / 4;
                            }
                        });
                        
                        return size;
                    };
                    
                    const formatBytes = (bytes, decimals = 2) => {
                        if (bytes === 0) return '0 Bytes';
                        
                        const k = 1024;
                        const dm = decimals < 0 ? 0 : decimals;
                        const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                        
                        const i = Math.floor(Math.log(bytes) / Math.log(k));
                        
                        return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
                    };
                    
                    const calculateHealthScore = (totalProducts, r2Images, missingImages) => {
                        if (totalProducts === 0) return '0%';
                        
                        let score = 100;
                        
                        score -= (missingImages / totalProducts) * 50;
                        
                        const r2Ratio = r2Images / (totalProducts - missingImages);
                        score += r2Ratio * 20;
                        
                        score = Math.max(0, Math.min(100, score));
                        
                        return Math.round(score) + '%';
                    };
                    
                    const showOperationMessage = (text, type) => {
                        operationMessage.value = { text, type };
                        
                        if (type !== 'loading') {
                            setTimeout(() => {
                                operationMessage.value = { text: '', type: '' };
                            }, 5000);
                        }
                    };
                    
                    // Ê†áÁ≠æÈ°µÂàáÊç¢ - ‰øÆÂ§çÁÇπÂáªÂ§±ÁÅµÈóÆÈ¢ò
                    const switchTab = (tabName) => {
                        activeTab.value = tabName;
                        console.log(`ÂàáÊç¢Âà∞Ê†áÁ≠æÈ°µ: ${tabName}`);
                        
                        // Âº∫Âà∂ÈáçÊñ∞Ê∏≤ÊüìÊ†áÁ≠æÈ°µÂÜÖÂÆπ
                        nextTick(() => {
                            // Á°Æ‰øùDOMÂ∑≤Êõ¥Êñ∞
                            if (tabName === 'data') {
                                // Â¶ÇÊûúÊòØÊï∞ÊçÆÂ§á‰ªΩÊ†áÁ≠æÈ°µÔºåÈáçÊñ∞Âä†ËΩΩÂ§á‰ªΩÊñá‰ª∂ÂàóË°®
                                if (s3Client.value) {
                                    loadR2BackupFiles();
                                }
                            }
                        });
                    };
                    
                    // ÊêúÁ¥¢Áõ∏ÂÖ≥ÂäüËÉΩ
                    const handleSearch = (inputValue) => {
                        const input = (inputValue || searchInput.value).trim().toUpperCase();
                        if (!input) {
                            searchResults.value = [];
                            fuzzyMatches.value = [];
                            rangeResults.value = [];
                            return;
                        }
                        
                        if (!searchHistory.value.includes(input)) {
                            searchHistory.value.push(input);
                            if (searchHistory.value.length > 10) searchHistory.value.shift();
                            saveDataToR2();
                        }
                        
                        const parsed = parseRangeInput(input);
                        if (parsed.ranges.length > 0 && (parsed.type === 'price' || parsed.type === 'weight')) {
                            rangeResults.value = performRangeQuery(parsed.ranges, parsed.type);
                            searchResults.value = [];
                            fuzzyMatches.value = [];
                        } else {
                            const codes = input.split(/[\s,;\n]+/).map(c => c.trim()).filter(c => c.length > 0);
                            searchResults.value = [];
                            fuzzyMatches.value = [];
                            rangeResults.value = [];
                            
                            codes.forEach(code => {
                                if (catalogData.value[code]) {
                                    const result = JSON.parse(JSON.stringify(catalogData.value[code]));
                                    result.found = true;
                                    result.matchType = 'exact';
                                    searchResults.value.push(result);
                                } else {
                                    const matches = Object.keys(catalogData.value).filter(key => {
                                        const product = catalogData.value[key];
                                        const codeMatch = key.toUpperCase().includes(code);
                                        const supplierMatch = product.supplier && product.supplier !== '-' &&
                                                            product.supplier.toUpperCase().includes(code);
                                        return codeMatch || supplierMatch;
                                    });
                                    
                                    if (matches.length === 1) {
                                        const result = JSON.parse(JSON.stringify(catalogData.value[matches[0]]));
                                        result.found = true;
                                        result.matchType = 'fuzzy';
                                        searchResults.value.push(result);
                                    } else if (matches.length > 1) {
                                        fuzzyMatches.value.push({ searchTerm: code, matches: matches.slice(0, 50) });
                                    } else {
                                        searchResults.value.push({ code: code, found: false, error: 'Êú™ÊâæÂà∞ËØ•‰∫ßÂìÅ' });
                                    }
                                }
                            });
                        }
                    };
                    
                    const parseRangeInput = (input) => {
                        const ranges = [];
                        const items = input.split(/[,Ôºå\s]+/).map(item => item.trim()).filter(item => item);
                        let type = null;
                        
                        items.forEach(item => {
                            const upper = item.toUpperCase();
                            let min = null, max = null, label = item;
                            
                            if (upper.includes('ÂÖÉ')) {
                                type = 'price';
                                if (upper.includes('‰ª•‰∏ä')) {
                                    min = parseFloat(upper.replace(/[^0-9.]/g, ''));
                                    max = Infinity;
                                } else if (upper.includes('ÂÜÖ')) {
                                    max = parseFloat(upper.replace(/[^0-9.]/g, ''));
                                    min = 0;
                                } else {
                                    const match = upper.match(/(\d+(?:\.\d+)?)-(\d+(?:\.\d+)?)ÂÖÉ/);
                                    if (match) {
                                        min = parseFloat(match[1]);
                                        max = parseFloat(match[2]);
                                    }
                                }
                            } else if (upper.includes('ÂÖã')) {
                                type = 'weight';
                                if (upper.includes('‰ª•‰∏ä')) {
                                    min = parseFloat(upper.replace(/[^0-9.]/g, ''));
                                    max = Infinity;
                                } else if (upper.includes('ÂÜÖ')) {
                                    max = parseFloat(upper.replace(/[^0-9.]/g, ''));
                                    min = 0;
                                } else {
                                    const match = upper.match(/(\d+(?:\.\d+)?)-(\d+(?:\.\d+)?)ÂÖã/);
                                    if (match) {
                                        min = parseFloat(match[1]);
                                        max = parseFloat(match[2]);
                                    }
                                }
                            }
                            
                            if (min !== null || max !== null) {
                                ranges.push({ min, max, label, type });
                            }
                        });
                        
                        return { ranges, type };
                    };
                    
                    const performRangeQuery = (ranges, type) => {
                        const results = [];
                        const field = type === 'price' ? 'priceAlt' : 'weight';
                        
                        ranges.forEach(range => {
                            const matches = [];
                            Object.values(catalogData.value).forEach(product => {
                                const value = parseFloat(product[field]);
                                if (!isNaN(value) && value >= (range.min || 0) && value <= (range.max || Infinity)) {
                                    const match = JSON.parse(JSON.stringify(product));
                                    match.matchType = 'range';
                                    match.rangeLabel = range.label;
                                    matches.push(match);
                                }
                            });
                            
                            matches.sort((a, b) => {
                                const seriesA = a.code.match(/^[YC]*([ACDFGJMST])/);
                                const seriesB = b.code.match(/^[YC]*([ACDFGJMST])/);
                                const seriesAChar = seriesA ? seriesA[1] : '';
                                const seriesBChar = seriesB ? seriesB[1] : '';
                                if (seriesAChar !== seriesBChar) return seriesAChar.localeCompare(seriesBChar);
                                const numA = parseInt(a.code.replace(/^[YC]*[ACDFGJMST]/, '')) || 0;
                                const numB = parseInt(b.code.replace(/^[YC]*[ACDFGJMST]/, '')) || 0;
                                return numA - numB;
                            });
                            
                            const result = JSON.parse(JSON.stringify(range));
                            result.matches = matches;
                            results.push(result);
                        });
                        
                        return results;
                    };
                    
                    const loadHistory = (query) => {
                        searchInput.value = query;
                        handleSearch(query);
                        activeTab.value = 'query';
                    };
                    
                    const clearSearchHistory = async () => {
                        if (!confirm('Á°ÆÂÆöË¶ÅÊ∏ÖÈô§ÊâÄÊúâÊêúÁ¥¢ÂéÜÂè≤ÂêóÔºü')) {
                            return;
                        }
                        
                        searchHistory.value = [];
                        await saveDataToR2();
                        showOperationMessage('ÊêúÁ¥¢ÂéÜÂè≤Â∑≤Ê∏ÖÈô§', 'success');
                    };
                    
                    const selectFuzzyMatch = (code) => {
                        searchInput.value = code;
                        handleSearch(code);
                        activeTab.value = 'query';
                    };
                    
                    const selectCode = (code) => {
                        searchInput.value = code;
                        handleSearch(code);
                        activeTab.value = 'query';
                    };
                    
                    // ‰∫ßÂìÅÁÆ°ÁêÜÁõ∏ÂÖ≥
                    const addOrUpdateProduct = async () => {
                        const code = productForm.code.trim().toUpperCase();
                        if (!code || !code.match(/^[YC]*[ACDFGJMST]\d+/)) {
                            showOperationMessage('‰∫ßÂìÅ‰ª£Á†ÅÊ†ºÂºèÊó†ÊïàÔºà‰æãÂ¶ÇÔºöC6001, YC2001Ôºâ', 'error');
                            return;
                        }
                        
                        if (catalogData.value[code] && editingProduct.value !== code) {
                            if (!confirm('‰∫ßÂìÅ‰ª£Á†ÅÂ∑≤Â≠òÂú®ÔºåÊòØÂê¶Ë¶ÜÁõñÔºü')) {
                                return;
                            }
                        }
                        
                        let imageUrl = catalogData.value[code] ? catalogData.value[code].image : null;
                        
                        if (productForm.imageFile) {
                            if (productForm.imageFile.size > 5 * 1024 * 1024) {
                                showOperationMessage('ÂõæÁâáËøáÂ§ßÔºà>5MBÔºâÔºåËØ∑ÂéãÁº©Âêé‰∏ä‰º†', 'error');
                                return;
                            }
                            
                            try {
                                showOperationMessage('Ê≠£Âú®‰∏ä‰º†ÂõæÁâá...', 'loading');
                                imageUrl = await uploadToR2(productForm.imageFile, code);
                                showOperationMessage('ÂõæÁâá‰∏ä‰º†ÊàêÂäü', 'success');
                            } catch (error) {
                                console.error('Cloudflare R2‰∏ä‰º†Â§±Ë¥•:', error);
                                showOperationMessage('ÂõæÁâá‰∏ä‰º†Â§±Ë¥•: ' + error.message, 'error');
                                return;
                            }
                        }
                        
                        catalogData.value[code] = {
                            code: code,
                            price: productForm.price || '-',
                            priceAlt: productForm.priceAlt || '-',
                            width: productForm.width || '-',
                            composition: productForm.composition || '-',
                            weight: productForm.weight || '-',
                            notes: productForm.notes || '-',
                            supplier: productForm.supplier || '-',
                            image: imageUrl
                        };
                        
                        try {
                            await saveDataToR2();
                            
                            if (editingProduct.value) {
                                showOperationMessage('‰∫ßÂìÅÂ∑≤Êõ¥Êñ∞', 'success');
                            } else {
                                showOperationMessage('‰∫ßÂìÅÂ∑≤Ê∑ªÂä†', 'success');
                            }
                            
                            clearProductForm();
                            renderManageProducts();
                        } catch (error) {
                            console.error('‰øùÂ≠òÂ§±Ë¥•:', error);
                            showOperationMessage('‰øùÂ≠òÂ§±Ë¥•ÔºåËØ∑ÈáçËØï', 'error');
                        }
                    };
                    
                    const editProduct = (code) => {
                        const product = catalogData.value[code];
                        if (!product) return;
                        
                        activeTab.value = 'manage';
                        
                        editingProduct.value = code;
                        productForm.code = product.code;
                        productForm.price = product.price;
                        productForm.priceAlt = product.priceAlt;
                        productForm.width = product.width;
                        productForm.composition = product.composition;
                        productForm.weight = product.weight;
                        productForm.notes = product.notes;
                        productForm.supplier = product.supplier;
                        productForm.imageFile = null;
                        
                        showOperationMessage('ÁºñËæëÊ®°ÂºèÔºö‰øÆÊîπÂêéÁÇπÂáª"Êõ¥Êñ∞‰∫ßÂìÅ"', 'loading');
                        
                        // Êñ∞Â¢ûÔºöËá™Âä®ÊªöÂä®Âà∞Ë°®ÂçïÂå∫Âüü
                        nextTick(() => {
                            const formElement = document.querySelector('.product-form-section');
                            if (formElement) {
                                formElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                            }
                        });
                    };
                    
                    const deleteProduct = async () => {
                        if (!editingProduct.value) return;
                        
                        if (!confirm(`Á°ÆÂÆöÂà†Èô§Ê≠§‰∫ßÂìÅ ${editingProduct.value} ÂêóÔºü`)) {
                            return;
                        }
                        
                        delete catalogData.value[editingProduct.value];
                        await saveDataToR2();
                        clearProductForm();
                        renderManageProducts();
                        showOperationMessage('‰∫ßÂìÅÂ∑≤Âà†Èô§', 'success');
                    };
                    
                    const deleteProductFromList = async (code) => {
                        if (!confirm(`Á°ÆÂÆöÂà†Èô§‰∫ßÂìÅ ${code} ÂêóÔºü`)) {
                            return;
                        }
                        
                        delete catalogData.value[code];
                        await saveDataToR2();
                        renderManageProducts();
                        showOperationMessage('‰∫ßÂìÅÂ∑≤Âà†Èô§', 'success');
                    };
                    
                    const clearProductForm = () => {
                        productForm.code = '';
                        productForm.price = '';
                        productForm.priceAlt = '';
                        productForm.width = '';
                        productForm.composition = '';
                        productForm.weight = '';
                        productForm.notes = '';
                        productForm.supplier = '';
                        productForm.imageFile = null;
                        editingProduct.value = null;
                        operationMessage.value = { text: '', type: '' };
                    };
                    
                    const handleImageUpload = (event) => {
                        const file = event.target.files[0];
                        if (file) {
                            productForm.imageFile = file;
                        }
                    };
                    
                    // ESCÈîÆÂÖ≥Èó≠ÂõæÁâáÂäüËÉΩ
                    const handleKeyDown = (event) => {
                        if (event.key === 'Escape' && imageModalVisible.value) {
                            imageModalVisible.value = false;
                        }
                    };
                    
                    const showImage = (imageSrc, productCode) => {
                        currentImage.value = imageSrc;
                        imageModalVisible.value = true;
                        
                        // Ê∑ªÂä†ÈîÆÁõò‰∫ã‰ª∂ÁõëÂê¨
                        document.addEventListener('keydown', handleKeyDown);
                    };
                    
                    const closeImageModal = () => {
                        imageModalVisible.value = false;
                        // ÁßªÈô§ÈîÆÁõò‰∫ã‰ª∂ÁõëÂê¨
                        document.removeEventListener('keydown', handleKeyDown);
                    };
                    
                    // ‰∫ßÂìÅÁÆ°ÁêÜÂàóË°®Áõ∏ÂÖ≥
                    const filterManageProducts = () => {
                        manageCurrentPage.value = 1;
                        renderManageProducts();
                    };
                    
                    const renderManageProducts = () => {
                        filteredManageProducts.value = Object.keys(catalogData.value)
                            .filter(code => {
                                if (!manageSearchTerm.value) return true;
                                const product = catalogData.value[code];
                                return code.toUpperCase().includes(manageSearchTerm.value) || 
                                      (product.supplier && product.supplier.toUpperCase().includes(manageSearchTerm.value));
                            })
                            .sort();
                        
                        const startIndex = (manageCurrentPage.value - 1) * managePageSize.value;
                        const endIndex = startIndex + managePageSize.value;
                        const productsToShow = filteredManageProducts.value.slice(0, endIndex);
                        hasMoreProducts.value = endIndex < filteredManageProducts.value.length;
                        
                        return productsToShow;
                    };
                    
                    const loadMoreProducts = () => {
                        manageCurrentPage.value++;
                    };
                    
                    // R2ÈÖçÁΩÆÁõ∏ÂÖ≥
                    const saveR2Config = () => {
                        console.log("‰øùÂ≠òÈÖçÁΩÆÊåâÈíÆË¢´ÁÇπÂáª");
                        if (!r2Config.accountId || !r2Config.accessKey || 
                            !r2Config.secretKey || !r2Config.bucket || !r2Config.customDomain) {
                            showOperationMessage('ËØ∑Â°´ÂÜôÂÆåÊï¥ÁöÑCloudflare R2ÈÖçÁΩÆ', 'error');
                            return;
                        }
                        
                        // Á°Æ‰øùcustomDomain‰ª•ÊñúÊù†ÁªìÂ∞æ
                        const formattedCustomDomain = r2Config.customDomain.endsWith('/') ? 
                            r2Config.customDomain : r2Config.customDomain + '/';
                        r2Config.customDomain = formattedCustomDomain;
                        
                        localStorage.setItem('r2-config', JSON.stringify(r2Config));
                        showOperationMessage('Cloudflare R2ÈÖçÁΩÆÂ∑≤‰øùÂ≠ò', 'success');
                        
                        initS3Client();
                    };
                    
                    const loadR2Config = () => {
                        const savedConfig = JSON.parse(localStorage.getItem('r2-config') || '{}');
                        Object.assign(r2Config, savedConfig);
                        
                        if (r2Config.accessKey && r2Config.secretKey) {
                            initS3Client();
                        }
                    };
                    
                    const initS3Client = () => {
                        if (!r2Config.accessKey || !r2Config.secretKey) return;
                        
                        try {
                            AWS.config.update({
                                accessKeyId: r2Config.accessKey,
                                secretAccessKey: r2Config.secretKey,
                                region: 'auto'
                            });
                            
                            s3Client.value = new AWS.S3({
                                endpoint: `https://${r2Config.accountId}.r2.cloudflarestorage.com`,
                                signatureVersion: 'v4'
                            });
                            
                            console.log('Cloudflare R2 S3ÂÆ¢Êà∑Á´ØÂ∑≤ÂàùÂßãÂåñ');
                            loadDataFromR2();
                        } catch (error) {
                            console.error('S3ÂÆ¢Êà∑Á´ØÂàùÂßãÂåñÂ§±Ë¥•:', error);
                            showOperationMessage('S3ÂÆ¢Êà∑Á´ØÂàùÂßãÂåñÂ§±Ë¥•: ' + error.message, 'error');
                        }
                    };
                    
                    const testR2Connection = async () => {
                        console.log("ÊµãËØïËøûÊé•ÊåâÈíÆË¢´ÁÇπÂáª");
                        if (!r2Config.accessKey || !r2Config.bucket) {
                            showOperationMessage('ËØ∑ÂÖà‰øùÂ≠òCloudflare R2ÈÖçÁΩÆ', 'error');
                            return;
                        }
                        
                        if (!s3Client.value) initS3Client();
                        
                        showOperationMessage('Ê≠£Âú®ÊµãËØïR2ËøûÊé•...', 'loading');
                        
                        try {
                            const testContent = new Blob(['R2 Connection Test'], { type: 'text/plain' });
                            const testKey = `test-connection-${Date.now()}.txt`;
                            
                            await s3Client.value.putObject({
                                Bucket: r2Config.bucket,
                                Key: testKey,
                                Body: testContent,
                                ContentType: 'text/plain'
                            }).promise();
                            
                            // ÊµãËØïÊàêÂäüÔºåÂà†Èô§ÊµãËØïÊñá‰ª∂
                            await s3Client.value.deleteObject({
                                Bucket: r2Config.bucket,
                                Key: testKey
                            }).promise();
                            
                            // ÊµãËØïËá™ÂÆö‰πâÂüüÂêçËÆøÈóÆ
                            await testCustomDomainAccess();
                            
                            showOperationMessage('R2ËøûÊé•ÊµãËØïÊàêÂäüÔºÅ', 'success');
                        } catch (error) {
                            console.error('R2ËøûÊé•ÊµãËØïÂ§±Ë¥•:', error);
                            let errorMsg = 'R2ËøûÊé•ÊµãËØïÂ§±Ë¥•: ';
                            
                            if (error.statusCode === 403) {
                                errorMsg = 'ÊùÉÈôêÈîôËØØÔºöËØ∑Ê£ÄÊü•Access Key/Secret KeyÊòØÂê¶Ê≠£Á°Æ';
                            } else if (error.statusCode === 404) {
                                errorMsg = 'Â≠òÂÇ®Ê°∂‰∏çÂ≠òÂú®ÔºöËØ∑Ê£ÄÊü•BucketÂêçÁß∞ÊòØÂê¶Ê≠£Á°Æ';
                            } else if (error.statusCode === 400) {
                                errorMsg = 'ËØ∑Ê±ÇÂèÇÊï∞ÈîôËØØÔºöËØ∑Ê£ÄÊü•ÈÖçÁΩÆÊ†ºÂºè';
                            } else if (error.code === 'NetworkingError' || error.message?.includes('CORS')) {
                                errorMsg = 'ÁΩëÁªúÈîôËØØÔºöËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•ÊàñCORSÈÖçÁΩÆ';
                            } else {
                                errorMsg += error.message || 'Êú™Áü•ÈîôËØØÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•ÂíåÈÖçÁΩÆ';
                            }
                            
                            showOperationMessage(errorMsg, 'error');
                        }
                    };
                    
                    const testCustomDomainAccess = () => {
                        return new Promise((resolve) => {
                            if (!r2Config.customDomain) {
                                resolve();
                                return;
                            }
                            
                            const testImageUrl = `${r2Config.customDomain}yudong-fabric/test-image-${Date.now()}.jpg`;
                            const testImage = new Image();
                            
                            testImage.onload = function() {
                                console.log('Ëá™ÂÆö‰πâÂüüÂêçËÆøÈóÆÊ≠£Â∏∏');
                                resolve();
                            };
                            
                            testImage.onerror = function() {
                                console.warn('Ëá™ÂÆö‰πâÂüüÂêçËÆøÈóÆÂèØËÉΩÊúâÈóÆÈ¢ò');
                                resolve();
                            };
                            
                            testImage.src = testImageUrl;
                        });
                    };
                    
                    // Êï∞ÊçÆÂ≠òÂÇ®Áõ∏ÂÖ≥
                    const generateImageUrl = (productCode) => {
                        if (!r2Config.customDomain) {
                            console.warn('R2Ëá™ÂÆö‰πâÂüüÂêçÊú™ÈÖçÁΩÆ');
                            return null;
                        }
                        
                        const baseUrl = r2Config.customDomain.endsWith('/') ? 
                            r2Config.customDomain : r2Config.customDomain + '/';
                        
                        return `${baseUrl}yudong-fabric/${productCode}.jpg`;
                    };
                    
                    const uploadToR2 = (file, productCode) => {
                        return new Promise((resolve, reject) => {
                            if (!s3Client.value) {
                                reject(new Error('ËØ∑ÂÖàÈÖçÁΩÆCloudflare R2'));
                                return;
                            }
                            
                            const key = `yudong-fabric/${productCode}.jpg`;
                            
                            s3Client.value.putObject({
                                Bucket: r2Config.bucket,
                                Key: key,
                                Body: file,
                                ContentType: 'image/jpeg'
                            }, function(err, data) {
                                if (err) {
                                    console.error('R2‰∏ä‰º†Â§±Ë¥•:', err);
                                    reject(err);
                                } else {
                                    console.log('R2‰∏ä‰º†ÊàêÂäü:', data);
                                    const imageUrl = generateImageUrl(productCode);
                                    console.log('ÁîüÊàêÁöÑÂõæÁâáURL:', imageUrl);
                                    
                                    verifyImageAccess(imageUrl, productCode)
                                        .then(() => resolve(imageUrl))
                                        .catch(verifyErr => {
                                            console.warn('ÂõæÁâáÈ™åËØÅÂ§±Ë¥•Ôºå‰ΩÜÁªßÁª≠‰ΩøÁî®URL:', verifyErr);
                                            resolve(imageUrl);
                                        });
                                }
                            });
                        });
                    };
                    
                    const verifyImageAccess = (imageUrl, productCode) => {
                        return new Promise((resolve, reject) => {
                            const testImage = new Image();
                            testImage.onload = function() {
                                console.log(`‚úÖ ÂõæÁâá ${productCode} ÂèØÊ≠£Â∏∏ËÆøÈóÆ`);
                                resolve();
                            };
                            testImage.onerror = function() {
                                console.error(`‚ùå ÂõæÁâá ${productCode} Êó†Ê≥ïËÆøÈóÆÔºåËØ∑Ê£ÄÊü•R2ÂÖ¨ÂÖ±ËÆøÈóÆËÆæÁΩÆ`);
                                reject(new Error(`ÂõæÁâá ${productCode} Êó†Ê≥ïÂÖ¨ÂºÄËÆøÈóÆ`));
                            };
                            testImage.src = imageUrl + '?t=' + Date.now();
                        });
                    };
                    
                    const saveDataToR2 = async () => {
                        if (!s3Client.value) {
                            console.warn('R2Êú™ÈÖçÁΩÆÔºåÊó†Ê≥ï‰øùÂ≠òÊï∞ÊçÆÂà∞‰∫ëÁ´Ø');
                            return;
                        }
                        
                        const dataToSave = {
                            catalogData: catalogData.value,
                            searchHistory: searchHistory.value,
                            saveTime: new Date().toISOString(),
                            version: '5.0-vue'
                        };
                        
                        const dataBlob = new Blob([JSON.stringify(dataToSave, null, 2)], { type: 'application/json' });
                        const key = 'yudong-cloud/database.json';
                        
                        try {
                            await s3Client.value.upload({
                                Bucket: r2Config.bucket,
                                Key: key,
                                Body: dataBlob,
                                ContentType: 'application/json'
                            }).promise();
                            
                            console.log('Êï∞ÊçÆÂ∑≤‰øùÂ≠òÂà∞R2');
                        } catch (error) {
                            console.error('‰øùÂ≠òÊï∞ÊçÆÂà∞R2Â§±Ë¥•:', error);
                            showOperationMessage('‰øùÂ≠òÊï∞ÊçÆÂà∞R2Â§±Ë¥•: ' + error.message, 'error');
                        }
                    };
                    
                    const loadDataFromR2 = async () => {
                        if (!s3Client.value) {
                            console.warn('R2Êú™ÈÖçÁΩÆÔºåÊó†Ê≥ï‰ªé‰∫ëÁ´ØÂä†ËΩΩÊï∞ÊçÆ');
                            return;
                        }
                        
                        try {
                            const data = await s3Client.value.getObject({
                                Bucket: r2Config.bucket,
                                Key: 'yudong-cloud/database.json'
                            }).promise();
                            
                            const dataToLoad = JSON.parse(data.Body.toString());
                            catalogData.value = dataToLoad.catalogData || {};
                            searchHistory.value = dataToLoad.searchHistory || [];
                            
                            console.log('Êï∞ÊçÆÂ∑≤‰ªéR2Âä†ËΩΩ');
                            showOperationMessage('Êï∞ÊçÆÂä†ËΩΩÊàêÂäü', 'success');
                        } catch (error) {
                            console.warn('‰ªéR2Âä†ËΩΩÊï∞ÊçÆÂ§±Ë¥•Ôºå‰ΩøÁî®Á©∫Êï∞ÊçÆ:', error);
                            catalogData.value = {};
                            searchHistory.value = [];
                        }
                    };
                    
                    // Êï∞ÊçÆÂ§á‰ªΩÁõ∏ÂÖ≥
                    const exportAndUploadBackup = async () => {
                        if (Object.keys(catalogData.value).length === 0) {
                            showOperationMessage('Êó†Êï∞ÊçÆÂèØÂØºÂá∫', 'error');
                            return;
                        }
                        
                        showOperationMessage('Ê≠£Âú®ÁîüÊàêÂ§á‰ªΩÊñá‰ª∂...', 'loading');
                        
                        try {
                            const zip = new JSZip();
                            const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
                            
                            const fullData = {
                                catalogData: catalogData.value,
                                searchHistory: searchHistory.value,
                                exportTime: new Date().toISOString(),
                                version: '5.0-vue'
                            };
                            
                            zip.file('database.json', JSON.stringify(fullData, null, 2));
                            
                            try {
                                const rows = [['‰∫ßÂìÅ‰ª£Á†Å', 'Á†Å‰ª∑', 'Á±≥‰ª∑', 'Èó®ÂπÖ', 'ÊàêÂàÜ', 'ÂÖãÈáç', 'Â§áÊ≥®', '‰æõÂ∫îÂïÜ']];
                                Object.values(catalogData.value).forEach(p => {
                                    rows.push([
                                        p.code || '-',
                                        p.price || '-',
                                        p.priceAlt || '-',
                                        p.width || '-',
                                        p.composition || '-',
                                        p.weight || '-',
                                        p.notes || '-',
                                        p.supplier || '-'
                                    ]);
                                });
                                
                                const wb = XLSX.utils.book_new();
                                const ws = XLSX.utils.aoa_to_sheet(rows);
                                XLSX.utils.book_append_sheet(wb, ws, '‰∫ßÂìÅÊï∞ÊçÆ');
                                const xlsxBuffer = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });
                                zip.file('‰∫ßÂìÅÊï∞ÊçÆË°®.xlsx', xlsxBuffer);
                            } catch (xlsxError) {
                                console.error('XLSX generation error:', xlsxError);
                            }
                            
                            const content = await zip.generateAsync({
                                type: 'blob',
                                compression: 'DEFLATE',
                                compressionOptions: { level: 6 }
                            });
                            
                            // ‰∏ãËΩΩÂà∞Êú¨Âú∞
                            const link = document.createElement('a');
                            link.href = URL.createObjectURL(content);
                            link.download = 'ÂÆá‰∏úÁ∫∫ÁªáÂÖ®Â∫ìÂ§á‰ªΩ_' + timestamp + '.zip';
                            link.click();
                            URL.revokeObjectURL(link.href);
                            
                            // ‰∏ä‰º†Âà∞Cloudflare R2
                            try {
                                await uploadBackupToR2(content, link.download);
                                showOperationMessage('‚úÖ ÂÆåÊï¥Â§á‰ªΩÂØºÂá∫ÊàêÂäüÔºÅÂ∑≤ÂêåÊ≠•Âà∞Cloudflare R2„ÄÇ', 'success');
                            } catch (error) {
                                console.error('Â§á‰ªΩ‰∏ä‰º†Â§±Ë¥•:', error);
                                showOperationMessage('‚úÖ Â§á‰ªΩÂØºÂá∫ÊàêÂäüÔºå‰ΩÜ‰∏ä‰º†Âà∞R2Â§±Ë¥•: ' + error.message, 'warning');
                            }
                        } catch (error) {
                            console.error('ZIP generation error:', error);
                            showOperationMessage('ÂØºÂá∫Â§±Ë¥•Ôºö' + error.message, 'error');
                        }
                    };
                    
                    const uploadBackupToR2 = (backupBlob, fileName) => {
                        return new Promise((resolve, reject) => {
                            if (!s3Client.value) {
                                reject(new Error('ËØ∑ÂÖàÈÖçÁΩÆCloudflare R2'));
                                return;
                            }
                            
                            const key = `yudong-cloud/${fileName}`;
                            
                            s3Client.value.upload({
                                Bucket: r2Config.bucket,
                                Key: key,
                                Body: backupBlob,
                                ContentType: 'application/zip'
                            }, function(err, data) {
                                if (err) {
                                    console.error('Â§á‰ªΩ‰∏ä‰º†Â§±Ë¥•:', err);
                                    reject(err);
                                } else {
                                    resolve(data);
                                }
                            });
                        });
                    };
                    
                    const loadR2BackupFiles = async () => {
                        console.log("Cloudflare R2ÂØºÂÖ•ÊåâÈíÆË¢´ÁÇπÂáª");
                        if (!s3Client.value) {
                            showOperationMessage('ËØ∑ÂÖàÈÖçÁΩÆCloudflare R2', 'error');
                            return;
                        }
                        
                        showOperationMessage('Ê≠£Âú®Âä†ËΩΩR2Â§á‰ªΩÊñá‰ª∂...', 'loading');
                        
                        try {
                            const data = await s3Client.value.listObjectsV2({
                                Bucket: r2Config.bucket,
                                Prefix: 'yudong-cloud/'
                            }).promise();
                            
                            backupFiles.value = data.Contents.filter(item => 
                                item.Key.endsWith('.zip') && item.Key.startsWith('yudong-cloud/')
                            ).sort((a, b) => new Date(b.LastModified) - new Date(a.LastModified));
                            
                            showOperationMessage(`ÊâæÂà∞ ${backupFiles.value.length} ‰∏™Â§á‰ªΩÊñá‰ª∂`, 'success');
                        } catch (error) {
                            console.error('Âä†ËΩΩÂ§á‰ªΩÊñá‰ª∂ÂàóË°®Â§±Ë¥•:', error);
                            showOperationMessage('Âä†ËΩΩÂ§á‰ªΩÊñá‰ª∂ÂàóË°®Â§±Ë¥•: ' + error.message, 'error');
                        }
                    };
                    
                    const importFromR2Backup = async (fileKey) => {
                        if (!confirm('Á°ÆÂÆöË¶Å‰ªéËØ•Â§á‰ªΩÊñá‰ª∂ÂØºÂÖ•Êï∞ÊçÆÂêóÔºüËøôÂ∞ÜË¶ÜÁõñÂΩìÂâçÊâÄÊúâÊï∞ÊçÆ„ÄÇ')) {
                            return;
                        }
                        
                        showOperationMessage('Ê≠£Âú®‰ªéR2Â§á‰ªΩÂØºÂÖ•Êï∞ÊçÆ...', 'loading');
                        
                        try {
                            const data = await s3Client.value.getObject({
                                Bucket: r2Config.bucket,
                                Key: fileKey
                            }).promise();
                            
                            const blob = new Blob([data.Body], { type: 'application/zip' });
                            await importDatabase([new File([blob], fileKey.split('/').pop())]);
                        } catch (error) {
                            console.error('‰∏ãËΩΩÂ§á‰ªΩÊñá‰ª∂Â§±Ë¥•:', error);
                            showOperationMessage('‰∏ãËΩΩÂ§á‰ªΩÊñá‰ª∂Â§±Ë¥•: ' + error.message, 'error');
                        }
                    };
                    
                    const importDatabase = async (files) => {
                        if (files.length === 0) return;
                        const file = files[0];
                        
                        showOperationMessage('Ê≠£Âú®ÂØºÂÖ•Êï∞ÊçÆÂ∫ì...', 'loading');
                        
                        try {
                            if (file.name.endsWith('.json')) {
                                const text = await readFileAsText(file);
                                const data = JSON.parse(text);
                                
                                if (data.catalogData) {
                                    catalogData.value = data.catalogData;
                                    searchHistory.value = data.searchHistory || [];
                                } else {
                                    catalogData.value = data;
                                }
                                
                                await saveDataToR2();
                                renderManageProducts();
                                showOperationMessage('‚úÖ Êï∞ÊçÆÂ∫ìÂØºÂÖ•ÊàêÂäüÔºÅ', 'success');
                            } else if (file.name.endsWith('.zip')) {
                                const arrayBuffer = await readFileAsArrayBuffer(file);
                                const zip = await JSZip.loadAsync(arrayBuffer);
                                
                                const jsonFile = zip.file('database.json') || zip.file('Êï∞ÊçÆÂ∫ìÂ§á‰ªΩ.json');
                                
                                if (jsonFile) {
                                    const jsonStr = await jsonFile.async('string');
                                    const data = JSON.parse(jsonStr);
                                    
                                    if (data.catalogData) {
                                        catalogData.value = data.catalogData;
                                        searchHistory.value = data.searchHistory || [];
                                    } else {
                                        catalogData.value = data;
                                    }
                                    
                                    await saveDataToR2();
                                    renderManageProducts();
                                    showOperationMessage('‚úÖ Êï∞ÊçÆÂ∫ìÂØºÂÖ•ÊàêÂäüÔºÅÂÖ± ' + Object.keys(catalogData.value).length + ' Êù°Êï∞ÊçÆ', 'success');
                                } else {
                                    showOperationMessage('ÂØºÂÖ•Â§±Ë¥•ÔºöZIP‰∏≠Êú™ÊâæÂà∞database.jsonÊàñÊï∞ÊçÆÂ∫ìÂ§á‰ªΩ.json', 'error');
                                }
                            } else {
                                showOperationMessage('‰∏çÊîØÊåÅÁöÑÊñá‰ª∂Ê†ºÂºèÔºåËØ∑‰∏ä‰º†.jsonÊàñ.zipÊñá‰ª∂', 'error');
                            }
                        } catch (error) {
                            console.error('ÂØºÂÖ•Â§±Ë¥•:', error);
                            showOperationMessage('ÂØºÂÖ•Â§±Ë¥•Ôºö' + error.message, 'error');
                        }
                    };
                    
                    const readFileAsText = (file) => {
                        return new Promise((resolve, reject) => {
                            const reader = new FileReader();
                            reader.onload = e => resolve(e.target.result);
                            reader.onerror = () => reject(new Error('Êñá‰ª∂ËØªÂèñÂ§±Ë¥•'));
                            reader.readAsText(file);
                        });
                    };
                    
                    const readFileAsArrayBuffer = (file) => {
                        return new Promise((resolve, reject) => {
                            const reader = new FileReader();
                            reader.onload = e => resolve(e.target.result);
                            reader.onerror = () => reject(new Error('Êñá‰ª∂ËØªÂèñÂ§±Ë¥•'));
                            reader.readAsArrayBuffer(file);
                        });
                    };
                    
                    const clearData = async () => {
                        if (!confirm('‚ö†Ô∏è Á°ÆÂÆöË¶ÅÊ∏ÖÁ©∫ÊâÄÊúâÊï∞ÊçÆÂêóÔºü\n\nÊ≠§Êìç‰ΩúÂ∞ÜÂà†Èô§ÊâÄÊúâ‰∫ßÂìÅÊï∞ÊçÆÔºå‰∏îÊó†Ê≥ïÊÅ¢Â§çÔºÅ')) {
                            return;
                        }
                        
                        catalogData.value = {};
                        searchResults.value = [];
                        fuzzyMatches.value = [];
                        rangeResults.value = [];
                        
                        await saveDataToR2();
                        renderManageProducts();
                        showOperationMessage('ÊâÄÊúâÊï∞ÊçÆÂ∑≤Ê∏ÖÁ©∫', 'success');
                    };
                    
                    // PDFÂØºÂá∫
                    const exportQuotePDF = () => {
                        const allResults = [];
                        if (rangeResults.value.length > 0) {
                            rangeResults.value.forEach(range => { 
                                range.matches.forEach(product => { allResults.push(product); }); 
                            });
                        } else {
                            searchResults.value.filter(r => r.found).forEach(r => allResults.push(r));
                        }
                        
                        if (allResults.length === 0) {
                            showOperationMessage('Êó†ÁªìÊûúÂèØÂØºÂá∫', 'error');
                            return;
                        }
                        
                        showOperationMessage('Ê≠£Âú®ÁîüÊàêÊä•‰ª∑PDF...', 'loading');
                        
                        const printContainer = document.createElement('div');
                        printContainer.id = 'pdf-content';
                        printContainer.style.cssText = 'position: absolute; left: -9999px; width: 250mm; font-family: "Microsoft YaHei", "ÂæÆËΩØÈõÖÈªë", sans-serif; background: white; padding: 15mm; line-height: 1.1;';
                        document.body.appendChild(printContainer);
                        
                        let html = '<h1 style="text-align: center; color: #40A891; font-size: 16pt; margin-bottom: 8mm; border-bottom: 2px solid #40A891; padding-bottom: 4mm;">üìä ÂÆá‰∏úÁ∫∫ÁªáÊä•‰ª∑Âçï</h1>';
                        html += '<div style="text-align: center; color: #666; margin-bottom: 6mm; font-size: 8pt;">ÁîüÊàêÊó∂Èó¥Ôºö' + new Date().toLocaleString('zh-CN') + ' | ‰∫ßÂìÅÊï∞ÈáèÔºö' + allResults.length + ' È°π</div>';
                        html += '<table style="width: 100%; border-collapse: collapse; margin-bottom: 4mm; page-break-inside: auto; font-size: 7pt;">';
                        html += '<thead><tr style="page-break-inside: avoid; page-break-after: auto;">';
                        html += '<th style="width: 6%; background-color: #40A891; color: white; padding: 5pt 3pt; text-align: center; font-size: 8pt; border: 1px solid #333; font-weight: bold;">Â∫èÂè∑</th>';
                        html += '<th style="width: 14%; background-color: #40A891; color: white; padding: 5pt 3pt; text-align: center; font-size: 8pt; border: 1px solid #333; font-weight: bold;">‰∫ßÂìÅ‰ª£Á†Å</th>';
                        html += '<th style="width: 9%; background-color: #40A891; color: white; padding: 5pt 3pt; text-align: center; font-size: 8pt; border: 1px solid #333; font-weight: bold;">Á†Å‰ª∑</th>';
                        html += '<th style="width: 9%; background-color: #40A891; color: white; padding: 5pt 3pt; text-align: center; font-size: 8pt; border: 1px solid #333; font-weight: bold;">Á±≥‰ª∑</th>';
                        html += '<th style="width: 9%; background-color: #40A891; color: white; padding: 5pt 3pt; text-align: center; font-size: 8pt; border: 1px solid #333; font-weight: bold;">Èó®ÂπÖ</th>';
                        html += '<th style="width: 14%; background-color: #40A891; color: white; padding: 5pt 3pt; text-align: center; font-size: 8pt; border: 1px solid #333; font-weight: bold;">ÊàêÂàÜ</th>';
                        html += '<th style="width: 9%; background-color: #40A891; color: white; padding: 5pt 3pt; text-align: center; font-size: 8pt; border: 1px solid #333; font-weight: bold;">ÂÖãÈáç</th>';
                        html += '<th style="width: 20%; background-color: #40A891; color: white; padding: 5pt 3pt; text-align: center; font-size: 8pt; border: 1px solid #333; font-weight: bold;">Â§áÊ≥®</th>';
                        html += '</tr></thead><tbody>';
                        
                        allResults.forEach((product, index) => {
                            html += '<tr style="page-break-inside: avoid; page-break-after: auto; height: auto; min-height: 12pt;">';
                            html += '<td style="padding: 3pt 2pt; text-align: center; border: 1px solid #ddd; font-size: 7pt; vertical-align: middle;">' + (index + 1) + '</td>';
                            html += '<td style="padding: 3pt 2pt; text-align: center; border: 1px solid #ddd; font-size: 7pt; vertical-align: middle;"><strong>' + product.code + '</strong></td>';
                            html += '<td style="padding: 3pt 2pt; text-align: center; border: 1px solid #ddd; font-size: 7pt; vertical-align: middle;">' + product.price + '</td>';
                            html += '<td style="padding: 3pt 2pt; text-align: center; border: 1px solid #ddd; font-size: 7pt; vertical-align: middle;">' + product.priceAlt + '</td>';
                            html += '<td style="padding: 3pt 2pt; text-align: center; border: 1px solid #ddd; font-size: 7pt; vertical-align: middle;">' + product.width + '</td>';
                            html += '<td style="padding: 3pt 2pt; text-align: center; border: 1px solid #ddd; font-size: 7pt; vertical-align: middle; word-wrap: break-word;">' + product.composition + '</td>';
                            html += '<td style="padding: 3pt 2pt; text-align: center; border: 1px solid #ddd; font-size: 7pt; vertical-align: middle;">' + product.weight + '</td>';
                            html += '<td style="padding: 3pt 2pt; text-align: left; border: 1px solid #ddd; font-size: 6pt; vertical-align: top; color: #d32f2f; word-wrap: break-word; overflow-wrap: break-word; white-space: pre-wrap; line-height: 1.2; hyphens: auto; display: block;">' + (product.notes && product.notes !== '-' ? product.notes : '') + '</td>';
                            html += '</tr>';
                        });
                        
                        html += '</tbody></table>';
                        html += '<div style="text-align: center; color: #999; font-size: 6pt; margin-top: 8mm; border-top: 1px solid #ddd; padding-top: 4mm;">Êú¨Êä•‰ª∑ÂçïÁî±ÂÆá‰∏úÁ∫∫ÁªáÊä•‰ª∑Á≥ªÁªüÁîüÊàê | Á≥ªÁªüÁâàÊú¨Ôºöv5.0-Vue</div>';
                        printContainer.innerHTML = html;
                        
                        html2canvas(printContainer, {
                            scale: 2,
                            useCORS: true,
                            allowTaint: true,
                            backgroundColor: '#ffffff',
                            width: printContainer.scrollWidth,
                            height: printContainer.scrollHeight,
                            logging: false
                        }).then(canvas => {
                            const { jsPDF } = window.jspdf;
                            const pdf = new jsPDF('l', 'mm', 'a4');
                            const pdfWidth = pdf.internal.pageSize.getWidth();
                            const pdfHeight = pdf.internal.pageSize.getHeight();
                            const imgWidth = pdfWidth - 30;
                            const pageHeight = pdfHeight - 30;
                            const imgHeight = (canvas.height * imgWidth) / canvas.width;
                            let heightLeft = imgHeight;
                            let position = 15;
                            
                            pdf.addImage(canvas.toDataURL('image/png'), 'PNG', 15, position, imgWidth, imgHeight);
                            heightLeft -= pageHeight;
                            
                            while (heightLeft >= 0) {
                                position = heightLeft - imgHeight + 15;
                                pdf.addPage();
                                pdf.addImage(canvas.toDataURL('image/png'), 'PNG', 15, position, imgWidth, imgHeight);
                                heightLeft -= pageHeight;
                            }
                            
                            pdf.save('Êä•‰ª∑Âçï_' + new Date().toISOString().slice(0, 10) + '.pdf');
                            showOperationMessage('‚úÖ PDFÁîüÊàêÊàêÂäüÔºÅ', 'success');
                            document.body.removeChild(printContainer);
                        }).catch(error => {
                            console.error('PDF generation error:', error);
                            showOperationMessage('PDFÁîüÊàêÂ§±Ë¥•ÔºåËØ∑ÈáçËØï', 'error');
                            document.body.removeChild(printContainer);
                        });
                    };
                    
                    // ÂàùÂßãÂåñ
                    onMounted(() => {
                        // Ê®°ÊãüÂàùÂßãÂåñËøáÁ®ã
                        setTimeout(() => {
                            loadR2Config();
                            loading.value = false;
                        }, 1000);
                    });
                    
                    // ÁõëÂê¨ÊêúÁ¥¢ËæìÂÖ•ÂèòÂåñ
                    let searchTimeout;
                    watch(searchInput, (newValue) => {
                        clearTimeout(searchTimeout);
                        if (newValue && Object.keys(catalogData.value).length > 0) {
                            searchTimeout = setTimeout(() => {
                                handleSearch(newValue);
                            }, 300);
                        } else {
                            searchResults.value = [];
                            fuzzyMatches.value = [];
                            rangeResults.value = [];
                        }
                    });
                    
                    return {
                        loading,
                        activeTab,
                        searchInput,
                        searchHistory,
                        catalogData,
                        searchResults,
                        fuzzyMatches,
                        rangeResults,
                        manageSearchTerm,
                        manageCurrentPage,
                        managePageSize,
                        filteredManageProducts,
                        hasMoreProducts,
                        editingProduct,
                        productForm,
                        r2Config,
                        s3Client,
                        imageModalVisible,
                        currentImage,
                        backupFiles,
                        operationMessage,
                        stats,
                        storageStatus,
                        switchTab,
                        handleSearch,
                        loadHistory,
                        clearSearchHistory,
                        selectFuzzyMatch,
                        selectCode,
                        addOrUpdateProduct,
                        editProduct,
                        deleteProduct,
                        deleteProductFromList,
                        clearProductForm,
                        handleImageUpload,
                        showImage,
                        closeImageModal,
                        filterManageProducts,
                        renderManageProducts,
                        loadMoreProducts,
                        saveR2Config,
                        testR2Connection,
                        exportAndUploadBackup,
                        loadR2BackupFiles,
                        importFromR2Backup,
                        importDatabase,
                        clearData,
                        exportQuotePDF
                    };
                },
                
                template: `
                <div class="min-h-screen bg-gray-50">
                    <!-- Âä†ËΩΩÁä∂ÊÄÅ -->
                    <div v-if="loading" class="fixed inset-0 bg-white bg-opacity-80 flex items-center justify-center z-50">
                        <div class="text-center">
                            <div class="inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-green-500"></div>
                            <p class="mt-4 text-gray-600">Á≥ªÁªüÂàùÂßãÂåñ‰∏≠...</p>
                        </div>
                    </div>
                    
                    <!-- ‰∏ªË¶ÅÂÜÖÂÆπ -->
                    <div v-if="!loading" class="min-h-screen bg-gray-50">
                        <!-- È°∂ÈÉ® Header -->
                        <div class="gradient-bg text-white shadow-lg header-section">
                            <div class="container mx-auto px-4 py-6">
                                <div class="text-center mb-4">
                                    <h1 class="text-2xl md:text-3xl font-bold mb-2">üìä ÂÆá‰∏úÁ∫∫ÁªáÊä•‰ª∑Á≥ªÁªü</h1>
                                    <p class="text-sm md:text-base opacity-90">Êô∫ËÉΩÊü•ËØ¢ ¬∑ Êï∞ÊçÆÁÆ°ÁêÜ ¬∑ ‰∏ì‰∏öÊä•‰ª∑</p>
                                </div>
                                
                                <!-- ÁªüËÆ°Âç°Áâá -->
                                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-2 mb-4">
                                    <div class="stat-card rounded-lg p-3 text-center">
                                        <div class="text-xl font-bold">{{ stats.totalProducts }}</div>
                                        <div class="text-xs opacity-90">‰∫ßÂìÅÊÄªÊï∞</div>
                                    </div>
                                    <div class="stat-card rounded-lg p-3 text-center">
                                        <div class="text-xl font-bold">{{ stats.r2Images }}</div>
                                        <div class="text-xs opacity-90">R2ÂõæÁâá</div>
                                    </div>
                                    <div class="stat-card rounded-lg p-3 text-center">
                                        <div class="text-xl font-bold">{{ stats.localImages }}</div>
                                        <div class="text-xs opacity-90">Êú¨Âú∞ÂõæÁâá</div>
                                    </div>
                                    <div class="stat-card rounded-lg p-3 text-center">
                                        <div class="text-xl font-bold">{{ stats.missingImages }}</div>
                                        <div class="text-xs opacity-90">Áº∫Â§±ÂõæÁâá</div>
                                    </div>
                                    <div class="stat-card rounded-lg p-3 text-center">
                                        <div class="text-xl font-bold">{{ stats.storageUsage }}</div>
                                        <div class="text-xs opacity-90">Â≠òÂÇ®Áî®Èáè</div>
                                    </div>
                                    <div class="stat-card rounded-lg p-3 text-center">
                                        <div class="text-xl font-bold">{{ stats.systemHealth }}</div>
                                        <div class="text-xs opacity-90">Á≥ªÁªüÂÅ•Â∫∑</div>
                                    </div>
                                </div>
                                
                                <!-- Â≠òÂÇ®Áä∂ÊÄÅ -->
                                <div class="flex flex-col md:flex-row justify-between items-center bg-white bg-opacity-15 rounded-lg p-3 text-sm">
                                    <div class="flex items-center space-x-2 mb-2 md:mb-0">
                                        <span>üíæ Â≠òÂÇ®ÂàÜÂ∏É:</span>
                                        <span class="px-2 py-1 rounded-full bg-yellow-500 bg-opacity-20 text-yellow-300 text-xs">Êú¨Âú∞: {{ stats.localImages }}</span>
                                        <span class="px-2 py-1 rounded-full bg-green-500 bg-opacity-20 text-green-300 text-xs">R2: {{ stats.r2Images }}</span>
                                    </div>
                                    <div>
                                        <span>{{ s3Client ? '‚úÖ ‰∫ëÁ´ØÂêåÊ≠•' : '‚ö†Ô∏è ‰ªÖÊú¨Âú∞' }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ê†áÁ≠æÈ°µÂØºËà™ -->
                        <div class="container mx-auto px-4 main-content relative z-10">
                            <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                                <!-- Ê†áÁ≠æÈ°µÊåâÈíÆ -->
                                <div class="flex border-b">
                                    <button 
                                        @click="switchTab('query')"
                                        :class="{'tab-button active text-white': activeTab === 'query', 'tab-button text-gray-600': activeTab !== 'query'}"
                                        class="flex-1 py-4 text-center font-semibold transition-all"
                                    >
                                        üîç Êü•ËØ¢Êä•‰ª∑
                                    </button>
                                    <button 
                                        @click="switchTab('manage')"
                                        :class="{'tab-button active text-white': activeTab === 'manage', 'tab-button text-gray-600': activeTab !== 'manage'}"
                                        class="flex-1 py-4 text-center font-semibold transition-all"
                                    >
                                        üõ†Ô∏è ‰∫ßÂìÅÁÆ°ÁêÜ
                                    </button>
                                    <button 
                                        @click="switchTab('data')"
                                        :class="{'tab-button active text-white': activeTab === 'data', 'tab-button text-gray-600': activeTab !== 'data'}"
                                        class="flex-1 py-4 text-center font-semibold transition-all"
                                    >
                                        üì¶ Êï∞ÊçÆÂ§á‰ªΩ
                                    </button>
                                </div>
                                
                                <!-- Ê†áÁ≠æÈ°µÂÜÖÂÆπ -->
                                <div class="p-6">
                                    <!-- Êü•ËØ¢Êä•‰ª∑ -->
                                    <div v-if="activeTab === 'query'" class="space-y-6">
                                        <h2 class="text-xl font-bold text-gray-800 border-b pb-2">‰∫ßÂìÅÊô∫ËÉΩÊü•ËØ¢</h2>
                                        
                                        <div class="relative">
                                            <textarea 
                                                v-model="searchInput" 
                                                class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" 
                                                rows="4" 
                                                placeholder="ËæìÂÖ•‰∫ßÂìÅ‰ª£Á†Å„ÄÅ‰æõÂ∫îÂïÜÊàñ‰ª∑Ê†º/ÂÖãÈáçÂå∫Èó¥...

Á§∫‰æãÔºö
‚Ä¢ ‰∫ßÂìÅ‰ª£Á†ÅÔºöC6001, Y6
‚Ä¢ ‰æõÂ∫îÂïÜÔºöÊ∞∏ËÅî
‚Ä¢ ‰ª∑Ê†ºÂå∫Èó¥Ôºö20ÂÖÉ‰ª•‰∏ä, 10-15ÂÖÉ
‚Ä¢ ÂÖãÈáçÂå∫Èó¥Ôºö100ÂÖãÂÜÖ, 150-200ÂÖã"
                                            ></textarea>
                                        </div>
                                        
                                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                            <p class="text-blue-800">
                                                üí° ÂÆûÊó∂Êô∫ËÉΩÊêúÁ¥¢Â∑≤ÂºÄÂêØÔºöËæìÂÖ•Âç≥Ëá™Âä®ÂåπÈÖç‰∫ßÂìÅ‰ª£Á†Å„ÄÅ‰æõÂ∫îÂïÜ„ÄÅ‰ª∑Ê†º/ÂÖãÈáçÂå∫Èó¥„ÄÇÊîØÊåÅÊâπÈáèÊü•ËØ¢„ÄÅÊ®°Á≥äÊêúÁ¥¢‰∏éÂéÜÂè≤ËÆ∞ÂΩïÂø´ÈÄüË∞ÉÁî®„ÄÇ
                                            </p>
                                        </div>
                                        
                                        <!-- ÊêúÁ¥¢ÂéÜÂè≤ -->
                                        <div>
                                            <h3 class="text-lg font-semibold text-gray-700 mb-2">‚åö ÊêúÁ¥¢ÂéÜÂè≤</h3>
                                            <div class="flex flex-wrap gap-2">
                                                <span 
                                                    v-for="(item, index) in searchHistory.slice(-5).reverse()" 
                                                    :key="index"
                                                    class="px-3 py-1 bg-gray-100 rounded-full text-sm cursor-pointer hover:bg-green-500 hover:text-white transition-colors"
                                                    @click="loadHistory(item)"
                                                >
                                                    {{ item }}
                                                </span>
                                            </div>
                                        </div>
                                        
                                        <div class="flex flex-wrap gap-3">
                                            <button 
                                                class="px-4 py-2 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
                                                :disabled="searchResults.length === 0 && rangeResults.length === 0"
                                                @click="exportQuotePDF"
                                            >
                                                üìÑ ÂØºÂá∫Êä•‰ª∑PDF
                                            </button>
                                            <button 
                                                class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors"
                                                @click="clearSearchHistory"
                                            >
                                                üóëÔ∏è Ê∏ÖÈô§ÂéÜÂè≤
                                            </button>
                                        </div>
                                        
                                        <!-- ÊêúÁ¥¢ÁªìÊûú -->
                                        <div class="mt-6 space-y-4">
                                            <!-- ÊêúÁ¥¢ÁªìÊûúÁªüËÆ° -->
                                            <div v-if="searchResults.length > 0" class="bg-green-50 border border-green-200 rounded-lg p-4">
                                                <p class="text-green-800">
                                                    üìä ÂÖ±Êü•ËØ¢ <strong>{{ searchResults.length }}</strong> ‰∏™‰∫ßÂìÅÔºåÊâæÂà∞ 
                                                    <strong>{{ searchResults.filter(r => r.found).length }}</strong> ‰∏™ÂåπÈÖçÁªìÊûú
                                                </p>
                                            </div>
                                            
                                            <!-- Ê®°Á≥äÂåπÈÖçÁªìÊûú -->
                                            <div v-for="fuzzy in fuzzyMatches" :key="fuzzy.searchTerm" class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                                <p class="text-yellow-800 font-semibold mb-2">
                                                    üîç Ê®°Á≥äÊêúÁ¥¢ "{{ fuzzy.searchTerm }}" ÊâæÂà∞ {{ fuzzy.matches.length }} ‰∏™ÂåπÈÖç
                                                </p>
                                                <div class="flex flex-wrap gap-2">
                                                    <span
                                                        v-for="match in fuzzy.matches"
                                                        :key="match"
                                                        class="px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm cursor-pointer hover:bg-yellow-500 hover:text-white transition-colors"
                                                        @click="selectFuzzyMatch(match)"
                                                    >
                                                        {{ match }}
                                                    </span>
                                                </div>
                                            </div>
                                            
                                            <!-- Âå∫Èó¥Êü•ËØ¢ÁªìÊûú -->
                                            <div v-for="range in rangeResults" :key="range.label" class="border border-gray-200 rounded-lg overflow-hidden">
                                                <div class="bg-green-50 p-4 border-b border-green-200 flex justify-between items-center">
                                                    <span class="text-green-800 font-semibold">{{ range.label }}</span>
                                                    <span class="px-2 py-1 bg-green-500 text-white rounded-full text-xs font-semibold">
                                                        ÂåπÈÖç {{ range.matches.length }} ‰∏™‰∫ßÂìÅ
                                                    </span>
                                                </div>
                                                
                                                <div v-if="range.matches.length > 0" class="p-4">
                                                    <h4 class="text-sm font-semibold text-gray-600 mb-3">
                                                        üìã ÂåπÈÖç‰∫ßÂìÅÁºñÂè∑ ({{ range.matches.length }} ‰∏™)
                                                    </h4>
                                                    <div class="flex flex-wrap gap-2 mb-4">
                                                        <span
                                                            v-for="product in range.matches"
                                                            :key="product.code"
                                                            class="px-3 py-1 bg-gray-100 rounded-full text-sm cursor-pointer hover:bg-green-500 hover:text-white transition-colors"
                                                            @click="selectCode(product.code)"
                                                        >
                                                            {{ product.code }}
                                                        </span>
                                                    </div>
                                                    
                                                    <!-- ‰∫ßÂìÅÂç°Áâá -->
                                                    <div class="space-y-4">
                                                        <div 
                                                            v-for="product in range.matches" 
                                                            :key="product.code"
                                                            class="product-card bg-white border border-gray-200 rounded-lg overflow-hidden"
                                                        >
                                                            <div class="bg-gray-50 p-4 border-b border-gray-200 flex justify-between items-center">
                                                                <span class="text-lg font-bold text-green-700">üì¶ {{ product.code }}</span>
                                                                <span class="px-2 py-1 bg-green-500 text-white rounded-full text-xs font-semibold">
                                                                    üìä Âå∫Èó¥ÂåπÈÖç
                                                                </span>
                                                            </div>
                                                            
                                                            <div class="p-4">
                                                                <div class="grid grid-cols-2 gap-4 mb-4">
                                                                    <div>
                                                                        <label class="text-xs text-gray-500">üí∞ Á†Å‰ª∑ (Y)</label>
                                                                        <div class="font-bold">{{ product.price }}</div>
                                                                    </div>
                                                                    <div>
                                                                        <label class="text-xs text-gray-500">üí∞ Á±≥‰ª∑ (M)</label>
                                                                        <div class="font-bold">{{ product.priceAlt }}</div>
                                                                    </div>
                                                                    <div>
                                                                        <label class="text-xs text-gray-500">üìè Èó®ÂπÖ</label>
                                                                        <div class="font-semibold">{{ product.width }}</div>
                                                                    </div>
                                                                    <div>
                                                                        <label class="text-xs text-gray-500">‚öñÔ∏è ÂÖãÈáç</label>
                                                                        <div class="font-semibold">{{ product.weight }}</div>
                                                                    </div>
                                                                    <div class="col-span-2">
                                                                        <label class="text-xs text-gray-500">üßµ ÊàêÂàÜ</label>
                                                                        <div class="font-semibold">{{ product.composition }}</div>
                                                                    </div>
                                                                </div>
                                                                
                                                                <div v-if="product.notes && product.notes !== '-'" class="bg-red-50 border border-red-200 rounded p-3 mb-4">
                                                                    <div class="font-bold text-red-700 mb-1">‚ö†Ô∏è Â§áÊ≥®</div>
                                                                    <div class="text-red-600">{{ product.notes }}</div>
                                                                </div>
                                                                
                                                                <div class="bg-gray-50 rounded p-3 flex items-center justify-between">
                                                                    <div class="flex items-center space-x-3">
                                                                        <span class="text-sm text-gray-600">üè≠ ‰æõÂ∫îÂïÜ</span>
                                                                        <span class="font-semibold">{{ product.supplier && product.supplier !== '-' ? product.supplier : 'ÊöÇÊó†‰ø°ÊÅØ' }}</span>
                                                                    </div>
                                                                    
                                                                    <button 
                                                                        v-if="product.image"
                                                                        class="px-3 py-1 bg-green-500 text-white rounded text-sm font-semibold hover:bg-green-600 transition-colors"
                                                                        @click="showImage(product.image, product.code)"
                                                                    >
                                                                        Êü•ÁúãÂ∫ïÂç°
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div v-else class="p-8 text-center">
                                                    <div class="text-4xl text-gray-300 mb-2">üîç</div>
                                                    <div class="text-gray-500">ÊöÇÊó†ÂåπÈÖç‰∫ßÂìÅ</div>
                                                    <div class="text-sm text-gray-400">ËØ•Âå∫Èó¥ÂÜÖÊ≤°ÊúâÊâæÂà∞‰∫ßÂìÅ</div>
                                                </div>
                                            </div>
                                            
                                            <!-- Á≤æÁ°ÆÂåπÈÖçÁªìÊûú -->
                                            <div class="space-y-4">
                                                <div 
                                                    v-for="result in searchResults" 
                                                    :key="result.code"
                                                    class="product-card bg-white border border-gray-200 rounded-lg overflow-hidden"
                                                >
                                                    <div v-if="result.found">
                                                        <div class="bg-gray-50 p-4 border-b border-gray-200 flex justify-between items-center">
                                                            <span class="text-lg font-bold text-green-700">üì¶ {{ result.code }}</span>
                                                            <span 
                                                                :class="{'bg-green-500': result.matchType === 'exact', 'bg-blue-500': result.matchType === 'fuzzy'}"
                                                                class="px-2 py-1 text-white rounded-full text-xs font-semibold"
                                                            >
                                                                {{ result.matchType === 'exact' ? '‚úì Á≤æÁ°ÆÂåπÈÖç' : 'üéØ Ê®°Á≥äÂåπÈÖç' }}
                                                            </span>
                                                        </div>
                                                        
                                                        <div class="p-4">
                                                            <div class="grid grid-cols-2 gap-4 mb-4">
                                                                <div>
                                                                    <label class="text-xs text-gray-500">üí∞ Á†Å‰ª∑ (Y)</label>
                                                                    <div class="font-bold">{{ result.price }}</div>
                                                                </div>
                                                                <div>
                                                                    <label class="text-xs text-gray-500">üí∞ Á±≥‰ª∑ (M)</label>
                                                                    <div class="font-bold">{{ result.priceAlt }}</div>
                                                                </div>
                                                                <div>
                                                                    <label class="text-xs text-gray-500">üìè Èó®ÂπÖ</label>
                                                                    <div class="font-semibold">{{ result.width }}</div>
                                                                </div>
                                                                <div>
                                                                    <label class="text-xs text-gray-500">‚öñÔ∏è ÂÖãÈáç</label>
                                                                    <div class="font-semibold">{{ result.weight }}</div>
                                                                </div>
                                                                <div class="col-span-2">
                                                                    <label class="text-xs text-gray-500">üßµ ÊàêÂàÜ</label>
                                                                    <div class="font-semibold">{{ result.composition }}</div>
                                                                </div>
                                                            </div>
                                                            
                                                            <div v-if="result.notes && result.notes !== '-'" class="bg-red-50 border border-red-200 rounded p-3 mb-4">
                                                                <div class="font-bold text-red-700 mb-1">‚ö†Ô∏è Â§áÊ≥®</div>
                                                                <div class="text-red-600">{{ result.notes }}</div>
                                                            </div>
                                                            
                                                            <div class="bg-gray-50 rounded p-3 flex items-center justify-between">
                                                                <div class="flex items-center space-x-3">
                                                                    <span class="text-sm text-gray-600">üè≠ ‰æõÂ∫îÂïÜ</span>
                                                                    <span class="font-semibold">{{ result.supplier && result.supplier !== '-' ? result.supplier : 'ÊöÇÊó†‰ø°ÊÅØ' }}</span>
                                                                </div>
                                                                
                                                                <button 
                                                                    v-if="result.image"
                                                                    class="px-3 py-1 bg-green-500 text-white rounded text-sm font-semibold hover:bg-green-600 transition-colors"
                                                                    @click="showImage(result.image, result.code)"
                                                                >
                                                                    Êü•ÁúãÂ∫ïÂç°
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                    <div v-else class="p-8 text-center">
                                                        <div class="text-4xl text-red-300 mb-2">‚ùå</div>
                                                        <div class="text-lg font-bold text-red-500">{{ result.code }}</div>
                                                        <div class="text-red-400">{{ result.error }}</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- ‰∫ßÂìÅÁÆ°ÁêÜ -->
                                    <div v-if="activeTab === 'manage'" class="space-y-6">
                                        <h2 class="text-xl font-bold text-gray-800 border-b pb-2">‰∫ßÂìÅÊï∞ÊçÆÁª¥Êä§</h2>
                                        
                                        <!-- Â≠òÂÇ®Áä∂ÊÄÅË≠¶Âëä -->
                                        <div v-if="storageStatus" :class="{'bg-red-50 border-red-200 text-red-700': storageStatus.type === 'error', 'bg-yellow-50 border-yellow-200 text-yellow-700': storageStatus.type === 'warning'}" class="border rounded-lg p-4">
                                            <div class="flex items-center">
                                                <span class="mr-2">{{ storageStatus.type === 'error' ? '‚ö†Ô∏è' : 'üíæ' }}</span>
                                                <span>{{ storageStatus.message }}</span>
                                            </div>
                                        </div>
                                        
                                        <!-- Ê∑ªÂä†/ÁºñËæë‰∫ßÂìÅË°®Âçï -->
                                        <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden product-form-section">
                                            <div class="bg-gray-50 p-4 border-b border-gray-200">
                                                <h3 class="text-lg font-bold text-green-700">‚ûï Ê∑ªÂä†/ÁºñËæë‰∫ßÂìÅ</h3>
                                            </div>
                                            
                                            <div class="p-4">
                                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                    <div>
                                                        <label class="block text-sm font-medium text-gray-700 mb-1">‰∫ßÂìÅ‰ª£Á†Å <span class="text-red-500">*</span></label>
                                                        <input 
                                                            v-model="productForm.code" 
                                                            type="text" 
                                                            class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                            placeholder="‰æãÂ¶ÇÔºöC6001, YC2001"
                                                        >
                                                    </div>
                                                    <div>
                                                        <label class="block text-sm font-medium text-gray-700 mb-1">Á†Å‰ª∑</label>
                                                        <input 
                                                            v-model="productForm.price" 
                                                            type="text" 
                                                            class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                            placeholder="‰æãÂ¶ÇÔºö12.5ÂÖÉ/Á†Å"
                                                        >
                                                    </div>
                                                    <div>
                                                        <label class="block text-sm font-medium text-gray-700 mb-1">Á±≥‰ª∑</label>
                                                        <input 
                                                            v-model="productForm.priceAlt" 
                                                            type="text" 
                                                            class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                            placeholder="‰æãÂ¶ÇÔºö12.5ÂÖÉ/Á±≥-Ë∂≥Á±≥"
                                                        >
                                                    </div>
                                                    <div>
                                                        <label class="block text-sm font-medium text-gray-700 mb-1">Èó®ÂπÖ</label>
                                                        <input 
                                                            v-model="productForm.width" 
                                                            type="text" 
                                                            class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                            placeholder="‰æãÂ¶ÇÔºö150cm"
                                                        >
                                                    </div>
                                                    <div>
                                                        <label class="block text-sm font-medium text-gray-700 mb-1">ÊàêÂàÜ</label>
                                                        <input 
                                                            v-model="productForm.composition" 
                                                            type="text" 
                                                            class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                            placeholder="‰æãÂ¶ÇÔºö100Èî¶Á∫∂"
                                                        >
                                                    </div>
                                                    <div>
                                                        <label class="block text-sm font-medium text-gray-700 mb-1">ÂÖãÈáç</label>
                                                        <input 
                                                            v-model="productForm.weight" 
                                                            type="text" 
                                                            class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                            placeholder="‰æãÂ¶ÇÔºö90ÂÖã/Âπ≥ÊñπÔºàgsmÔºâ"
                                                        >
                                                    </div>
                                                    <div class="md:col-span-2">
                                                        <label class="block text-sm font-medium text-gray-700 mb-1">Â§áÊ≥®</label>
                                                        <input 
                                                            v-model="productForm.notes" 
                                                            type="text" 
                                                            class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                            placeholder="‰æãÂ¶ÇÔºöÈ¢úËâ≤‰ª∑Ê†ºËØ¥ÊòéÁ≠â"
                                                        >
                                                    </div>
                                                    <div class="md:col-span-2">
                                                        <label class="block text-sm font-medium text-gray-700 mb-1">‰æõÂ∫îÂïÜ</label>
                                                        <input 
                                                            v-model="productForm.supplier" 
                                                            type="text" 
                                                            class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                            placeholder="‰æãÂ¶ÇÔºöÂáØÊ≥ìK5„ÄêKH86„Äë"
                                                        >
                                                    </div>
                                                    
                                                    <!-- ÂõæÁâá‰∏ä‰º† -->
                                                    <div class="md:col-span-2">
                                                        <label class="block text-sm font-medium text-gray-700 mb-1">Â∫ïÂç°ÂõæÁâá</label>
                                                        <input 
                                                            type="file" 
                                                            @change="handleImageUpload"
                                                            class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                            accept="image/*"
                                                        >
                                                        <p class="text-xs text-gray-500 mt-1">ÊîØÊåÅ JPG/PNG Ê†ºÂºèÔºåÂ§ßÂ∞è‰∏çË∂ÖËøá 5MB</p>
                                                        <div v-if="productForm.imageFile" class="mt-2 text-sm text-green-600">
                                                            Â∑≤ÈÄâÊã©: {{ productForm.imageFile.name }}
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="flex flex-wrap gap-3 mt-6">
                                                    <button 
                                                        v-if="!editingProduct" 
                                                        class="px-4 py-2 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition-colors"
                                                        @click="addOrUpdateProduct"
                                                    >
                                                        Ê∑ªÂä†‰∫ßÂìÅ
                                                    </button>
                                                    <button 
                                                        v-if="editingProduct" 
                                                        class="px-4 py-2 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition-colors"
                                                        @click="addOrUpdateProduct"
                                                    >
                                                        Êõ¥Êñ∞‰∫ßÂìÅ
                                                    </button>
                                                    <button 
                                                        v-if="editingProduct" 
                                                        class="px-4 py-2 bg-red-500 text-white rounded-lg font-semibold hover:bg-red-600 transition-colors"
                                                        @click="deleteProduct"
                                                    >
                                                        Âà†Èô§‰∫ßÂìÅ
                                                    </button>
                                                    <button 
                                                        class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors"
                                                        @click="clearProductForm"
                                                    >
                                                        Ê∏ÖÁ©∫Ë°®Âçï
                                                    </button>
                                                </div>
                                                
                                                <!-- Êìç‰ΩúÂèçÈ¶à -->
                                                <div v-if="operationMessage.text" :class="{'bg-green-50 text-green-700': operationMessage.type === 'success', 'bg-red-50 text-red-700': operationMessage.type === 'error', 'bg-blue-50 text-blue-700': operationMessage.type === 'loading'}" class="mt-4 p-3 rounded">
                                                    {{ operationMessage.text }}
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- ‰∫ßÂìÅÂàóË°® -->
                                        <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden">
                                            <div class="bg-gray-50 p-4 border-b border-gray-200">
                                                <h3 class="text-lg font-bold text-green-700">üîç ‰∫ßÂìÅÂàóË°®‰∏éÊêúÁ¥¢</h3>
                                            </div>
                                            
                                            <div class="p-4">
                                                <div class="mb-4">
                                                    <input
                                                        v-model="manageSearchTerm"
                                                        type="text"
                                                        class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                        placeholder="ÊêúÁ¥¢‰∫ßÂìÅ‰ª£Á†ÅÊàñ‰æõÂ∫îÂïÜ..."
                                                    >
                                                </div>
                                                
                                                <div class="space-y-4">
                                                    <div 
                                                        v-for="code in renderManageProducts()" 
                                                        :key="code"
                                                        class="product-card bg-white border border-gray-200 rounded-lg overflow-hidden"
                                                    >
                                                        <div class="p-4 border-b border-gray-200">
                                                            <div class="flex justify-between items-center">
                                                                <span class="text-lg font-bold text-green-700">üì¶ {{ code }}</span>
                                                                <div class="flex space-x-2">
                                                                    <button 
                                                                        class="px-3 py-1 bg-blue-500 text-white rounded text-sm font-semibold hover:bg-blue-600 transition-colors"
                                                                        @click="editProduct(code)"
                                                                    >
                                                                        ÁºñËæë
                                                                    </button>
                                                                    <button 
                                                                        class="px-3 py-1 bg-red-500 text-white rounded text-sm font-semibold hover:bg-red-600 transition-colors"
                                                                        @click="deleteProductFromList(code)"
                                                                    >
                                                                        Âà†Èô§
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        
                                                        <div class="p-4">
                                                            <div class="grid grid-cols-2 gap-4 mb-4">
                                                                <div class="text-center">
                                                                    <label class="text-xs text-gray-500">üí∞ Á†Å‰ª∑</label>
                                                                    <div class="font-bold">{{ catalogData[code].price }}</div>
                                                                </div>
                                                                <div class="text-center">
                                                                    <label class="text-xs text-gray-500">üí∞ Á±≥‰ª∑</label>
                                                                    <div class="font-bold">{{ catalogData[code].priceAlt }}</div>
                                                                </div>
                                                                <div class="text-center">
                                                                    <label class="text-xs text-gray-500">üìè Èó®ÂπÖ</label>
                                                                    <div class="font-semibold">{{ catalogData[code].width }}</div>
                                                                </div>
                                                                <div class="text-center">
                                                                    <label class="text-xs text-gray-500">‚öñÔ∏è ÂÖãÈáç</label>
                                                                    <div class="font-semibold">{{ catalogData[code].weight }}</div>
                                                                </div>
                                                                <div class="col-span-2 text-center">
                                                                    <label class="text-xs text-gray-500">üßµ ÊàêÂàÜ</label>
                                                                    <div class="font-semibold">{{ catalogData[code].composition }}</div>
                                                                </div>
                                                                <div class="col-span-2 text-center">
                                                                    <label class="text-xs text-gray-500">üè≠ ‰æõÂ∫îÂïÜ</label>
                                                                    <div class="font-semibold">{{ catalogData[code].supplier }}</div>
                                                                </div>
                                                            </div>
                                                            
                                                            <div v-if="catalogData[code].notes && catalogData[code].notes !== '-'" class="bg-red-50 border border-red-200 rounded p-3 mb-4">
                                                                <div class="text-red-700">{{ catalogData[code].notes }}</div>
                                                            </div>
                                                            
                                                            <div class="flex justify-center">
                                                                <div 
                                                                    v-if="catalogData[code].image"
                                                                    class="cursor-pointer"
                                                                    @click="showImage(catalogData[code].image, code)"
                                                                >
                                                                    <img 
                                                                        :src="catalogData[code].image" 
                                                                        :alt="'‰∫ßÂìÅ ' + code + ' Â∫ïÂç°ÂõæÁâá'"
                                                                        class="w-20 h-20 object-cover rounded border border-gray-200 image-preview"
                                                                        @error="e => e.target.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2YwZjBmMCIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGZpbGw9IiM5OTkiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj7lm77niYc8L3RleHQ+PC9zdmc+'"
                                                                    />
                                                                </div>
                                                                <div v-else class="w-20 h-20 bg-gray-100 rounded border border-gray-200 flex items-center justify-center text-gray-400 text-xs text-center">
                                                                    Êó†ÂõæÁâá
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                    <div v-if="renderManageProducts().length === 0" class="text-center p-8 bg-white rounded-lg border border-gray-200">
                                                        <div class="text-4xl text-gray-300 mb-2">üì¶</div>
                                                        <div class="text-gray-500">ÊöÇÊó†‰∫ßÂìÅ</div>
                                                        <div class="text-sm text-gray-400">ÈÄöËøá‰∏äÊñπË°®ÂçïÊ∑ªÂä†Êàñ‰∏ä‰º†Êñá‰ª∂ÂØºÂÖ•</div>
                                                    </div>
                                                    
                                                    <div v-if="hasMoreProducts" class="text-center mt-4">
                                                        <button 
                                                            class="px-4 py-2 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition-colors"
                                                            @click="loadMoreProducts"
                                                        >
                                                            Âä†ËΩΩÊõ¥Â§ö
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Êï∞ÊçÆÂ§á‰ªΩ -->
                                    <div v-if="activeTab === 'data'" class="space-y-6">
                                        <h2 class="text-xl font-bold text-gray-800 border-b pb-2">Êï∞ÊçÆÂ§á‰ªΩ</h2>
                                        
                                        <!-- Cloudflare R2ÈÖçÁΩÆ -->
                                        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                            <h3 class="text-lg font-bold text-green-700 mb-4">‚òÅÔ∏è Cloudflare R2 + Ëá™ÂÆö‰πâÂüüÂêçÈÖçÁΩÆ</h3>
                                            
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-1">Account ID</label>
                                                    <input 
                                                        v-model="r2Config.accountId" 
                                                        type="text" 
                                                        class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                        placeholder="ËØ∑ËæìÂÖ•Cloudflare Account ID"
                                                    >
                                                </div>
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-1">Access Key ID</label>
                                                    <input 
                                                        v-model="r2Config.accessKey" 
                                                        type="text" 
                                                        class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                        placeholder="ËØ∑ËæìÂÖ•R2 Access Key ID"
                                                    >
                                                </div>
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-1">Secret Access Key</label>
                                                    <input 
                                                        v-model="r2Config.secretKey" 
                                                        type="password" 
                                                        class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                        placeholder="ËØ∑ËæìÂÖ•R2 Secret Access Key"
                                                    >
                                                </div>
                                                <div>
                                                    <label class="block text-sm font-medium text-gray-700 mb-1">Bucket ÂêçÁß∞</label>
                                                    <input 
                                                        v-model="r2Config.bucket" 
                                                        type="text" 
                                                        class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                        placeholder="ËØ∑ËæìÂÖ•Â≠òÂÇ®Ê°∂ÂêçÁß∞"
                                                    >
                                                </div>
                                                <div class="md:col-span-2">
                                                    <label class="block text-sm font-medium text-gray-700 mb-1">Ëá™ÂÆö‰πâÂüüÂêç</label>
                                                    <input 
                                                        v-model="r2Config.customDomain" 
                                                        type="text" 
                                                        class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                        placeholder="https://img.yudong-textile.top"
                                                    >
                                                </div>
                                            </div>
                                            
                                            <div class="button-group">
                                                <button 
                                                    class="px-4 py-2 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition-colors"
                                                    @click="saveR2Config"
                                                >
                                                    ‰øùÂ≠òÈÖçÁΩÆ
                                                </button>
                                                <button 
                                                    class="px-4 py-2 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition-colors"
                                                    @click="testR2Connection"
                                                >
                                                    ÊµãËØïËøûÊé•
                                                </button>
                                            </div>
                                            
                                            <div class="bg-blue-50 border border-blue-200 rounded p-3 mt-4">
                                                <p class="text-blue-800">
                                                    üí° ÈÖçÁΩÆËØ¥ÊòéÔºöÂú®CloudflareÊéßÂà∂Âè∞ÂàõÂª∫R2Â≠òÂÇ®Ê°∂ÔºåÂ∞ÜÊÇ®ÁöÑÂüüÂêç img.yudong-textile.top ÈÄöËøáCNAMEËÆ∞ÂΩïÊåáÂêëR2Â≠òÂÇ®Ê°∂„ÄÇ
                                                </p>
                                            </div>
                                        </div>
                                        
                                        <div class="data-backup-grid">
                                            <!-- Êï∞ÊçÆ‰∏ä‰º†‰∏éÂØºÂÖ• -->
                                            <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden">
                                                <div class="bg-gray-50 p-4 border-b border-gray-200">
                                                    <h3 class="text-lg font-bold text-green-700">üì§ Êï∞ÊçÆ‰∏ä‰º†‰∏éÂØºÂÖ•</h3>
                                                </div>
                                                
                                                <div class="p-4 space-y-4">
                                                    <div class="button-group">
                                                        <div>
                                                            <input 
                                                                type="file" 
                                                                id="localDbInput"
                                                                @change="importDatabase"
                                                                accept=".json,.zip"
                                                                class="hidden"
                                                            >
                                                            <label 
                                                                for="localDbInput"
                                                                class="px-4 py-2 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition-colors cursor-pointer inline-block w-full text-center"
                                                            >
                                                                üìÇ Êú¨Âú∞DBÂØºÂÖ•
                                                            </label>
                                                        </div>
                                                        
                                                        <button 
                                                            class="px-4 py-2 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition-colors"
                                                            @click="loadR2BackupFiles"
                                                        >
                                                            ‚òÅÔ∏è Cloudflare R2ÂØºÂÖ•
                                                        </button>
                                                    </div>
                                                    
                                                    <!-- R2Â§á‰ªΩÊñá‰ª∂ÂàóË°® -->
                                                    <div v-if="backupFiles.length > 0" class="border border-gray-200 rounded-lg max-h-60 overflow-y-auto">
                                                        <div 
                                                            v-for="file in backupFiles" 
                                                            :key="file.Key"
                                                            class="p-3 border-b border-gray-200 last:border-b-0 hover:bg-gray-50 cursor-pointer flex justify-between items-center"
                                                            @click="importFromR2Backup(file.Key)"
                                                        >
                                                            <div>
                                                                <div class="font-semibold text-sm">{{ file.Key.replace('yudong-cloud/', '') }}</div>
                                                                <div class="text-xs text-gray-500">
                                                                    {{ formatBytes(file.Size) }} ¬∑ {{ new Date(file.LastModified).toLocaleString('zh-CN') }}
                                                                </div>
                                                            </div>
                                                            <span>‚¨áÔ∏è</span>
                                                        </div>
                                                    </div>
                                                    
                                                    <div class="bg-yellow-50 border border-yellow-200 rounded p-3">
                                                        <p class="text-yellow-800">
                                                            ÂØºÂÖ•Êï∞ÊçÆÂ∫ìÂ∞ÜË¶ÜÁõñÂΩìÂâçÊâÄÊúâ‰∫ßÂìÅÊï∞ÊçÆÔºåËØ∑Ë∞®ÊÖéÊìç‰Ωú„ÄÇ
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- Â§á‰ªΩ‰∏éÊ∏ÖÁ©∫ -->
                                            <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden">
                                                <div class="bg-gray-50 p-4 border-b border-gray-200">
                                                    <h3 class="text-lg font-bold text-green-700">üì• Êï∞ÊçÆÂ§á‰ªΩ‰∏éÊ∏ÖÁ©∫</h3>
                                                </div>
                                                
                                                <div class="p-4 space-y-4">
                                                    <div class="button-group">
                                                        <button 
                                                            class="px-4 py-2 bg-yellow-500 text-white rounded-lg font-semibold hover:bg-yellow-600 transition-colors"
                                                            @click="exportAndUploadBackup"
                                                        >
                                                            ZIP ÂØºÂá∫ÂÆåÊï¥Â§á‰ªΩ
                                                        </button>
                                                        <button 
                                                            class="px-4 py-2 bg-red-500 text-white rounded-lg font-semibold hover:bg-red-600 transition-colors"
                                                            @click="clearData"
                                                        >
                                                            ‚ö†Ô∏è Ê∏ÖÁ©∫ÊâÄÊúâÊï∞ÊçÆ
                                                        </button>
                                                    </div>
                                                    
                                                    <div class="bg-red-50 border border-red-200 rounded p-3">
                                                        <p class="text-red-700">
                                                            ÂÆåÊï¥Â§á‰ªΩÂåÖÂê´Êï∞ÊçÆË°®ÂíåÊâÄÊúâÂõæÁâáÔºåÂª∫ËÆÆÂÆöÊúüÂØºÂá∫„ÄÇ
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ÂõæÁâáÊ®°ÊÄÅÊ°Ü -->
                    <div v-if="imageModalVisible" class="fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 p-4">
                        <div class="bg-white rounded-lg max-w-4xl max-h-full overflow-auto relative">
                            <button 
                                class="absolute top-4 right-4 w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 transition-colors"
                                @click="closeImageModal"
                            >
                                ‚úï
                            </button>
                            <img :src="currentImage" alt="‰∫ßÂìÅÂ∫ïÂç°" class="max-w-full h-auto">
                        </div>
                    </div>
                </div>
                `
            });
            
            // ÊåÇËΩΩÂ∫îÁî®
            app.use(ElementPlus);
            app.mount('#app');
        });
    </script>
</body>
</html>