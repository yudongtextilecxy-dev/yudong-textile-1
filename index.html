<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®‡ä¸œçººç»‡æŠ¥ä»·ç³»ç»Ÿ - Cloudflare R2äº‘ç«¯ç‰ˆ</title>
    
    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    
    <!-- Element Plus -->
    <link rel="stylesheet" href="https://unpkg.com/element-plus/dist/index.css">
    <script src="https://unpkg.com/element-plus/dist/index.full.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- AWS SDK (å…¼å®¹Cloudflare R2) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aws-sdk/2.1462.0/aws-sdk.min.js"></script>
    
    <!-- å…¶ä»–å¿…è¦åº“ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <style>
        /* è‡ªå®šä¹‰æ ·å¼ */
        .gradient-bg {
            background: linear-gradient(135deg, #52D1B2 0%, #40A891 100%);
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(8px);
        }
        
        .tab-button {
            transition: all 0.3s ease;
            cursor: pointer;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        .tab-button.active {
            background: linear-gradient(135deg, #52D1B2 0%, #40A891 100%);
            color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .product-card {
            transition: all 0.3s ease;
        }
        
        .product-card:hover {
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }
        
        .image-preview {
            transition: all 0.3s ease;
        }
        
        .image-preview:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        /* æ–°å¢æ ·å¼ */
        .header-section {
            padding-bottom: 2rem;
        }
        
        .main-content {
            margin-top: 2rem;
        }
        
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }
        
        .button-group button {
            flex: 1 1 auto;
            min-width: 120px;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
        }
        
        .data-backup-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }
        
        @media (min-width: 768px) {
            .data-backup-grid {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        /* ä¿®å¤æ ‡ç­¾é¡µç‚¹å‡»é—®é¢˜ */
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* ç¼–è¾‘æŒ‰é’®æ»šåŠ¨æ•ˆæœ */
        .edit-form-container {
            scroll-margin-top: 20px;
        }
        
        /* ä¿®å¤æŒ‰é’®ç‚¹å‡»é—®é¢˜ */
        .action-button {
            cursor: pointer;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }
        
        /* å¤‡ä»½æ–‡ä»¶åˆ—è¡¨æ ·å¼ */
        .backup-file-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
        }
        
        .backup-file-item {
            padding: 0.75rem;
            border-bottom: 1px solid #e2e8f0;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .backup-file-item:hover {
            background-color: #f7fafc;
        }
        
        .backup-file-item:last-child {
            border-bottom: none;
        }
        
        /* é˜²æ­¢é•¿æ—¶é—´ä½¿ç”¨åæ ‡ç­¾é¡µå¤±çµ */
        .tab-container {
            position: relative;
            z-index: 10;
        }
        
        .tab-buttons {
            display: flex;
            width: 100%;
        }
        
        .tab-button {
            flex: 1;
            text-align: center;
            padding: 1rem 0;
            font-weight: 600;
            border: none;
            background: none;
            outline: none;
        }
        
        /* ç§»åŠ¨ç«¯ä¼˜åŒ– */
        .mobile-optimized {
            -webkit-overflow-scrolling: touch;
        }
        
        /* é˜²æ­¢ç‚¹å‡»å»¶è¿Ÿ */
        .no-tap-delay {
            touch-action: manipulation;
        }
        
        /* æ€§èƒ½ä¼˜åŒ– */
        .performance-optimized {
            will-change: transform;
            transform: translateZ(0);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div id="app"></div>

    <script>
        // ç¡®ä¿Vueå’ŒElement PlusåŠ è½½å®Œæˆ
        document.addEventListener('DOMContentLoaded', function() {
            const { createApp, ref, reactive, computed, onMounted, watch, nextTick } = Vue;
            const { ElMessage, ElMessageBox, ElLoading } = ElementPlus;
            
            // æ€§èƒ½ä¼˜åŒ–ï¼šé˜²æŠ–å‡½æ•°
            function debounce(func, wait) {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            }
            
            const app = createApp({
                setup() {
                    // å“åº”å¼æ•°æ®
                    const loading = ref(true);
                    const activeTab = ref('query');
                    const searchInput = ref('');
                    const searchHistory = ref([]);
                    const catalogData = ref({});
                    const searchResults = ref([]);
                    const fuzzyMatches = ref([]);
                    const rangeResults = ref([]);
                    const manageSearchTerm = ref('');
                    const manageCurrentPage = ref(1);
                    const managePageSize = ref(20);
                    const filteredManageProducts = ref([]);
                    const hasMoreProducts = ref(false);
                    const editingProduct = ref(null);
                    const productForm = reactive({
                        code: '',
                        price: '',
                        priceAlt: '',
                        width: '',
                        composition: '',
                        weight: '',
                        notes: '',
                        supplier: '',
                        imageFile: null
                    });
                    const r2Config = reactive({
                        accountId: '',
                        accessKey: '',
                        secretKey: '',
                        bucket: '',
                        customDomain: 'https://img.yudong-textile.top'
                    });
                    const s3Client = ref(null);
                    const imageModalVisible = ref(false);
                    const currentImage = ref('');
                    const backupFiles = ref([]);
                    const operationMessage = ref({ text: '', type: '' });
                    const showBackupFiles = ref(false);
                    
                    // è®¡ç®—å±æ€§
                    const stats = computed(() => {
                        const totalProducts = Object.keys(catalogData.value).length;
                        let r2Images = 0;
                        let localImages = 0;
                        let missingImages = 0;
                        
                        Object.values(catalogData.value).forEach(product => {
                            if (product.image) {
                                if (product.image.includes(r2Config.customDomain) || 
                                    product.image.includes('.r2.cloudflarestorage.com')) {
                                    r2Images++;
                                } else if (product.image.startsWith('data:image')) {
                                    localImages++;
                                } else {
                                    r2Images++;
                                }
                            } else {
                                missingImages++;
                            }
                        });
                        
                        const estimatedSize = estimateDataSize();
                        const healthScore = calculateHealthScore(totalProducts, r2Images, missingImages);
                        
                        return {
                            totalProducts,
                            r2Images,
                            localImages,
                            missingImages,
                            storageUsage: formatBytes(estimatedSize, 1),
                            systemHealth: healthScore
                        };
                    });
                    
                    const storageStatus = computed(() => {
                        const dataSize = estimateDataSize();
                        const warningThreshold = 10 * 1024 * 1024;
                        const criticalThreshold = 30 * 1024 * 1024;
                        
                        if (dataSize > criticalThreshold) {
                            return {
                                type: 'error',
                                message: `âš ï¸ å­˜å‚¨ç©ºé—´ç´§å¼  (${formatBytes(dataSize)}) - å»ºè®®ç«‹å³è¿ç§»åˆ°Cloudflare R2`
                            };
                        } else if (dataSize > warningThreshold) {
                            return {
                                type: 'warning',
                                message: `ğŸ’¾ å­˜å‚¨ä½¿ç”¨é‡è¾ƒé«˜ (${formatBytes(dataSize)}) - å»ºè®®é…ç½®Cloudflare R2`
                            };
                        } else {
                            return null;
                        }
                    });
                    
                    // å·¥å…·å‡½æ•°
                    const estimateDataSize = () => {
                        let size = 0;
                        
                        const dataStr = JSON.stringify(catalogData.value);
                        size += new Blob([dataStr]).size;
                        
                        Object.values(catalogData.value).forEach(product => {
                            if (product.image && product.image.startsWith('data:image')) {
                                size += product.image.length * 3 / 4;
                            }
                        });
                        
                        return size;
                    };
                    
                    const formatBytes = (bytes, decimals = 2) => {
                        if (bytes === 0) return '0 Bytes';
                        
                        const k = 1024;
                        const dm = decimals < 0 ? 0 : decimals;
                        const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                        
                        const i = Math.floor(Math.log(bytes) / Math.log(k));
                        
                        return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
                    };
                    
                    const calculateHealthScore = (totalProducts, r2Images, missingImages) => {
                        if (totalProducts === 0) return '0%';
                        
                        let score = 100;
                        
                        score -= (missingImages / totalProducts) * 50;
                        
                        const r2Ratio = r2Images / (totalProducts - missingImages);
                        score += r2Ratio * 20;
                        
                        score = Math.max(0, Math.min(100, score));
                        
                        return Math.round(score) + '%';
                    };
                    
                    const showOperationMessage = (text, type) => {
                        operationMessage.value = { text, type };
                        
                        if (type !== 'loading') {
                            setTimeout(() => {
                                operationMessage.value = { text: '', type: '' };
                            }, 5000);
                        }
                    };
                    
                    // æ ‡ç­¾é¡µåˆ‡æ¢ - ä¿®å¤ç‰ˆæœ¬
                    const switchTab = (tabName) => {
                        console.log('åˆ‡æ¢æ ‡ç­¾é¡µ:', tabName);
                        activeTab.value = tabName;
                        
                        // å¼ºåˆ¶æ›´æ–°DOM
                        nextTick(() => {
                            // ç¡®ä¿æ ‡ç­¾é¡µå†…å®¹æ­£ç¡®æ˜¾ç¤º
                            const tabContents = document.querySelectorAll('.tab-content');
                            tabContents.forEach(content => {
                                content.classList.remove('active');
                            });
                            
                            const activeContent = document.querySelector(`.tab-content[data-tab="${tabName}"]`);
                            if (activeContent) {
                                activeContent.classList.add('active');
                            }
                        });
                    };
                    
                    // æœç´¢ç›¸å…³åŠŸèƒ½
                    const handleSearch = debounce((inputValue) => {
                        const input = (inputValue || searchInput.value).trim().toUpperCase();
                        if (!input) {
                            searchResults.value = [];
                            fuzzyMatches.value = [];
                            rangeResults.value = [];
                            return;
                        }
                        
                        if (!searchHistory.value.includes(input)) {
                            searchHistory.value.push(input);
                            if (searchHistory.value.length > 10) searchHistory.value.shift();
                            saveDataToR2();
                        }
                        
                        const parsed = parseRangeInput(input);
                        if (parsed.ranges.length > 0 && (parsed.type === 'price' || parsed.type === 'weight')) {
                            rangeResults.value = performRangeQuery(parsed.ranges, parsed.type);
                            searchResults.value = [];
                            fuzzyMatches.value = [];
                        } else {
                            const codes = input.split(/[\s,;\n]+/).map(c => c.trim()).filter(c => c.length > 0);
                            searchResults.value = [];
                            fuzzyMatches.value = [];
                            rangeResults.value = [];
                            
                            codes.forEach(code => {
                                if (catalogData.value[code]) {
                                    const result = JSON.parse(JSON.stringify(catalogData.value[code]));
                                    result.found = true;
                                    result.matchType = 'exact';
                                    searchResults.value.push(result);
                                } else {
                                    const matches = Object.keys(catalogData.value).filter(key => {
                                        const product = catalogData.value[key];
                                        const codeMatch = key.toUpperCase().includes(code);
                                        const supplierMatch = product.supplier && product.supplier !== '-' &&
                                                            product.supplier.toUpperCase().includes(code);
                                        return codeMatch || supplierMatch;
                                    });
                                    
                                    if (matches.length === 1) {
                                        const result = JSON.parse(JSON.stringify(catalogData.value[matches[0]]));
                                        result.found = true;
                                        result.matchType = 'fuzzy';
                                        searchResults.value.push(result);
                                    } else if (matches.length > 1) {
                                        fuzzyMatches.value.push({ searchTerm: code, matches: matches.slice(0, 50) });
                                    } else {
                                        searchResults.value.push({ code: code, found: false, error: 'æœªæ‰¾åˆ°è¯¥äº§å“' });
                                    }
                                }
                            });
                        }
                    }, 300);
                    
                    const parseRangeInput = (input) => {
                        const ranges = [];
                        const items = input.split(/[,ï¼Œ\s]+/).map(item => item.trim()).filter(item => item);
                        let type = null;
                        
                        items.forEach(item => {
                            const upper = item.toUpperCase();
                            let min = null, max = null, label = item;
                            
                            if (upper.includes('å…ƒ')) {
                                type = 'price';
                                if (upper.includes('ä»¥ä¸Š')) {
                                    min = parseFloat(upper.replace(/[^0-9.]/g, ''));
                                    max = Infinity;
                                } else if (upper.includes('å†…')) {
                                    max = parseFloat(upper.replace(/[^0-9.]/g, ''));
                                    min = 0;
                                } else {
                                    const match = upper.match(/(\d+(?:\.\d+)?)-(\d+(?:\.\d+)?)å…ƒ/);
                                    if (match) {
                                        min = parseFloat(match[1]);
                                        max = parseFloat(match[2]);
                                    }
                                }
                            } else if (upper.includes('å…‹')) {
                                type = 'weight';
                                if (upper.includes('ä»¥ä¸Š')) {
                                    min = parseFloat(upper.replace(/[^0-9.]/g, ''));
                                    max = Infinity;
                                } else if (upper.includes('å†…')) {
                                    max = parseFloat(upper.replace(/[^0-9.]/g, ''));
                                    min = 0;
                                } else {
                                    const match = upper.match(/(\d+(?:\.\d+)?)-(\d+(?:\.\d+)?)å…‹/);
                                    if (match) {
                                        min = parseFloat(match[1]);
                                        max = parseFloat(match[2]);
                                    }
                                }
                            }
                            
                            if (min !== null || max !== null) {
                                ranges.push({ min, max, label, type });
                            }
                        });
                        
                        return { ranges, type };
                    };
                    
                    const performRangeQuery = (ranges, type) => {
                        const results = [];
                        const field = type === 'price' ? 'priceAlt' : 'weight';
                        
                        ranges.forEach(range => {
                            const matches = [];
                            Object.values(catalogData.value).forEach(product => {
                                const value = parseFloat(product[field]);
                                if (!isNaN(value) && value >= (range.min || 0) && value <= (range.max || Infinity)) {
                                    const match = JSON.parse(JSON.stringify(product));
                                    match.matchType = 'range';
                                    match.rangeLabel = range.label;
                                    matches.push(match);
                                }
                            });
                            
                            matches.sort((a, b) => {
                                const seriesA = a.code.match(/^[YC]*([ACDFGJMST])/);
                                const seriesB = b.code.match(/^[YC]*([ACDFGJMST])/);
                                const seriesAChar = seriesA ? seriesA[1] : '';
                                const seriesBChar = seriesB ? seriesB[1] : '';
                                if (seriesAChar !== seriesBChar) return seriesAChar.localeCompare(seriesBChar);
                                const numA = parseInt(a.code.replace(/^[YC]*[ACDFGJMST]/, '')) || 0;
                                const numB = parseInt(b.code.replace(/^[YC]*[ACDFGJMST]/, '')) || 0;
                                return numA - numB;
                            });
                            
                            const result = JSON.parse(JSON.stringify(range));
                            result.matches = matches;
                            results.push(result);
                        });
                        
                        return results;
                    };
                    
                    const loadHistory = (query) => {
                        searchInput.value = query;
                        handleSearch(query);
                        activeTab.value = 'query';
                    };
                    
                    const clearSearchHistory = async () => {
                        if (!confirm('ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰æœç´¢å†å²å—ï¼Ÿ')) {
                            return;
                        }
                        
                        searchHistory.value = [];
                        await saveDataToR2();
                        showOperationMessage('æœç´¢å†å²å·²æ¸…é™¤', 'success');
                    };
                    
                    const selectFuzzyMatch = (code) => {
                        searchInput.value = code;
                        handleSearch(code);
                        activeTab.value = 'query';
                    };
                    
                    const selectCode = (code) => {
                        searchInput.value = code;
                        handleSearch(code);
                        activeTab.value = 'query';
                    };
                    
                    // äº§å“ç®¡ç†ç›¸å…³
                    const addOrUpdateProduct = async () => {
                        const code = productForm.code.trim().toUpperCase();
                        if (!code || !code.match(/^[YC]*[ACDFGJMST]\d+/)) {
                            showOperationMessage('äº§å“ä»£ç æ ¼å¼æ— æ•ˆï¼ˆä¾‹å¦‚ï¼šC6001, YC2001ï¼‰', 'error');
                            return;
                        }
                        
                        if (catalogData.value[code] && editingProduct.value !== code) {
                            if (!confirm('äº§å“ä»£ç å·²å­˜åœ¨ï¼Œæ˜¯å¦è¦†ç›–ï¼Ÿ')) {
                                return;
                            }
                        }
                        
                        let imageUrl = catalogData.value[code] ? catalogData.value[code].image : null;
                        
                        if (productForm.imageFile) {
                            if (productForm.imageFile.size > 5 * 1024 * 1024) {
                                showOperationMessage('å›¾ç‰‡è¿‡å¤§ï¼ˆ>5MBï¼‰ï¼Œè¯·å‹ç¼©åä¸Šä¼ ', 'error');
                                return;
                            }
                            
                            try {
                                showOperationMessage('æ­£åœ¨ä¸Šä¼ å›¾ç‰‡...', 'loading');
                                imageUrl = await uploadToR2(productForm.imageFile, code);
                                showOperationMessage('å›¾ç‰‡ä¸Šä¼ æˆåŠŸ', 'success');
                            } catch (error) {
                                console.error('Cloudflare R2ä¸Šä¼ å¤±è´¥:', error);
                                showOperationMessage('å›¾ç‰‡ä¸Šä¼ å¤±è´¥: ' + error.message, 'error');
                                return;
                            }
                        }
                        
                        catalogData.value[code] = {
                            code: code,
                            price: productForm.price || '-',
                            priceAlt: productForm.priceAlt || '-',
                            width: productForm.width || '-',
                            composition: productForm.composition || '-',
                            weight: productForm.weight || '-',
                            notes: productForm.notes || '-',
                            supplier: productForm.supplier || '-',
                            image: imageUrl
                        };
                        
                        try {
                            await saveDataToR2();
                            
                            if (editingProduct.value) {
                                showOperationMessage('äº§å“å·²æ›´æ–°', 'success');
                            } else {
                                showOperationMessage('äº§å“å·²æ·»åŠ ', 'success');
                            }
                            
                            clearProductForm();
                            renderManageProducts();
                        } catch (error) {
                            console.error('ä¿å­˜å¤±è´¥:', error);
                            showOperationMessage('ä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
                        }
                    };
                    
                    // ç¼–è¾‘äº§å“ - ä¿®å¤ç‰ˆæœ¬ï¼Œæ·»åŠ æ»šåŠ¨åŠŸèƒ½
                    const editProduct = (code) => {
                        const product = catalogData.value[code];
                        if (!product) return;
                        
                        activeTab.value = 'manage';
                        
                        // ç­‰å¾…DOMæ›´æ–°åæ»šåŠ¨åˆ°ç¼–è¾‘è¡¨å•
                        nextTick(() => {
                            editingProduct.value = code;
                            productForm.code = product.code;
                            productForm.price = product.price;
                            productForm.priceAlt = product.priceAlt;
                            productForm.width = product.width;
                            productForm.composition = product.composition;
                            productForm.weight = product.weight;
                            productForm.notes = product.notes;
                            productForm.supplier = product.supplier;
                            productForm.imageFile = null;
                            
                            // æ»šåŠ¨åˆ°ç¼–è¾‘è¡¨å•
                            const editForm = document.getElementById('edit-product-form');
                            if (editForm) {
                                editForm.scrollIntoView({ behavior: 'smooth', block: 'start' });
                            }
                            
                            showOperationMessage('ç¼–è¾‘æ¨¡å¼ï¼šä¿®æ”¹åç‚¹å‡»"æ›´æ–°äº§å“"', 'loading');
                        });
                    };
                    
                    const deleteProduct = async () => {
                        if (!editingProduct.value) return;
                        
                        if (!confirm(`ç¡®å®šåˆ é™¤æ­¤äº§å“ ${editingProduct.value} å—ï¼Ÿ`)) {
                            return;
                        }
                        
                        delete catalogData.value[editingProduct.value];
                        await saveDataToR2();
                        clearProductForm();
                        renderManageProducts();
                        showOperationMessage('äº§å“å·²åˆ é™¤', 'success');
                    };
                    
                    const deleteProductFromList = async (code) => {
                        if (!confirm(`ç¡®å®šåˆ é™¤äº§å“ ${code} å—ï¼Ÿ`)) {
                            return;
                        }
                        
                        delete catalogData.value[code];
                        await saveDataToR2();
                        renderManageProducts();
                        showOperationMessage('äº§å“å·²åˆ é™¤', 'success');
                    };
                    
                    const clearProductForm = () => {
                        productForm.code = '';
                        productForm.price = '';
                        productForm.priceAlt = '';
                        productForm.width = '';
                        productForm.composition = '';
                        productForm.weight = '';
                        productForm.notes = '';
                        productForm.supplier = '';
                        productForm.imageFile = null;
                        editingProduct.value = null;
                        operationMessage.value = { text: '', type: '' };
                    };
                    
                    const handleImageUpload = (event) => {
                        const file = event.target.files[0];
                        if (file) {
                            productForm.imageFile = file;
                        }
                    };
                    
                    // ESCé”®å…³é—­å›¾ç‰‡åŠŸèƒ½
                    const handleKeyDown = (event) => {
                        if (event.key === 'Escape' && imageModalVisible.value) {
                            imageModalVisible.value = false;
                        }
                    };
                    
                    const showImage = (imageSrc, productCode) => {
                        currentImage.value = imageSrc;
                        imageModalVisible.value = true;
                        
                        // æ·»åŠ é”®ç›˜äº‹ä»¶ç›‘å¬
                        document.addEventListener('keydown', handleKeyDown);
                    };
                    
                    const closeImageModal = () => {
                        imageModalVisible.value = false;
                        // ç§»é™¤é”®ç›˜äº‹ä»¶ç›‘å¬
                        document.removeEventListener('keydown', handleKeyDown);
                    };
                    
                    // äº§å“ç®¡ç†åˆ—è¡¨ç›¸å…³
                    const filterManageProducts = () => {
                        manageCurrentPage.value = 1;
                        renderManageProducts();
                    };
                    
                    const renderManageProducts = () => {
                        filteredManageProducts.value = Object.keys(catalogData.value)
                            .filter(code => {
                                if (!manageSearchTerm.value) return true;
                                const product = catalogData.value[code];
                                return code.toUpperCase().includes(manageSearchTerm.value) || 
                                      (product.supplier && product.supplier.toUpperCase().includes(manageSearchTerm.value));
                            })
                            .sort();
                        
                        const startIndex = (manageCurrentPage.value - 1) * managePageSize.value;
                        const endIndex = startIndex + managePageSize.value;
                        const productsToShow = filteredManageProducts.value.slice(0, endIndex);
                        hasMoreProducts.value = endIndex < filteredManageProducts.value.length;
                        
                        return productsToShow;
                    };
                    
                    const loadMoreProducts = () => {
                        manageCurrentPage.value++;
                    };
                    
                    // R2é…ç½®ç›¸å…³ - ä¿®å¤ç‰ˆæœ¬
                    const saveR2Config = () => {
                        console.log('ä¿å­˜R2é…ç½®');
                        if (!r2Config.accountId || !r2Config.accessKey || 
                            !r2Config.secretKey || !r2Config.bucket || !r2Config.customDomain) {
                            showOperationMessage('è¯·å¡«å†™å®Œæ•´çš„Cloudflare R2é…ç½®', 'error');
                            return;
                        }
                        
                        // ç¡®ä¿customDomainä»¥æ–œæ ç»“å°¾
                        const formattedCustomDomain = r2Config.customDomain.endsWith('/') ? 
                            r2Config.customDomain : r2Config.customDomain + '/';
                        r2Config.customDomain = formattedCustomDomain;
                        
                        localStorage.setItem('r2-config', JSON.stringify(r2Config));
                        showOperationMessage('Cloudflare R2é…ç½®å·²ä¿å­˜', 'success');
                        
                        initS3Client();
                    };
                    
                    const loadR2Config = () => {
                        const savedConfig = JSON.parse(localStorage.getItem('r2-config') || '{}');
                        Object.assign(r2Config, savedConfig);
                        
                        if (r2Config.accessKey && r2Config.secretKey) {
                            initS3Client();
                        }
                    };
                    
                    const initS3Client = () => {
                        if (!r2Config.accessKey || !r2Config.secretKey) return;
                        
                        try {
                            AWS.config.update({
                                accessKeyId: r2Config.accessKey,
                                secretAccessKey: r2Config.secretKey,
                                region: 'auto'
                            });
                            
                            s3Client.value = new AWS.S3({
                                endpoint: `https://${r2Config.accountId}.r2.cloudflarestorage.com`,
                                signatureVersion: 'v4'
                            });
                            
                            console.log('Cloudflare R2 S3å®¢æˆ·ç«¯å·²åˆå§‹åŒ–');
                            loadDataFromR2();
                        } catch (error) {
                            console.error('S3å®¢æˆ·ç«¯åˆå§‹åŒ–å¤±è´¥:', error);
                            showOperationMessage('S3å®¢æˆ·ç«¯åˆå§‹åŒ–å¤±è´¥: ' + error.message, 'error');
                        }
                    };
                    
                    const testR2Connection = async () => {
                        console.log('æµ‹è¯•R2è¿æ¥');
                        if (!r2Config.accessKey || !r2Config.bucket) {
                            showOperationMessage('è¯·å…ˆä¿å­˜Cloudflare R2é…ç½®', 'error');
                            return;
                        }
                        
                        if (!s3Client.value) {
                            showOperationMessage('æ­£åœ¨åˆå§‹åŒ–S3å®¢æˆ·ç«¯...', 'loading');
                            initS3Client();
                            // ç­‰å¾…å®¢æˆ·ç«¯åˆå§‹åŒ–
                            await new Promise(resolve => setTimeout(resolve, 500));
                        }
                        
                        showOperationMessage('æ­£åœ¨æµ‹è¯•R2è¿æ¥...', 'loading');
                        
                        try {
                            const testContent = new Blob(['R2 Connection Test'], { type: 'text/plain' });
                            const testKey = `test-connection-${Date.now()}.txt`;
                            
                            await s3Client.value.putObject({
                                Bucket: r2Config.bucket,
                                Key: testKey,
                                Body: testContent,
                                ContentType: 'text/plain'
                            }).promise();
                            
                            // æµ‹è¯•æˆåŠŸï¼Œåˆ é™¤æµ‹è¯•æ–‡ä»¶
                            await s3Client.value.deleteObject({
                                Bucket: r2Config.bucket,
                                Key: testKey
                            }).promise();
                            
                            // æµ‹è¯•è‡ªå®šä¹‰åŸŸåè®¿é—®
                            await testCustomDomainAccess();
                            
                            showOperationMessage('R2è¿æ¥æµ‹è¯•æˆåŠŸï¼', 'success');
                        } catch (error) {
                            console.error('R2è¿æ¥æµ‹è¯•å¤±è´¥:', error);
                            let errorMsg = 'R2è¿æ¥æµ‹è¯•å¤±è´¥: ';
                            
                            if (error.statusCode === 403) {
                                errorMsg = 'æƒé™é”™è¯¯ï¼šè¯·æ£€æŸ¥Access Key/Secret Keyæ˜¯å¦æ­£ç¡®';
                            } else if (error.statusCode === 404) {
                                errorMsg = 'å­˜å‚¨æ¡¶ä¸å­˜åœ¨ï¼šè¯·æ£€æŸ¥Bucketåç§°æ˜¯å¦æ­£ç¡®';
                            } else if (error.statusCode === 400) {
                                errorMsg = 'è¯·æ±‚å‚æ•°é”™è¯¯ï¼šè¯·æ£€æŸ¥é…ç½®æ ¼å¼';
                            } else if (error.code === 'NetworkingError' || error.message?.includes('CORS')) {
                                errorMsg = 'ç½‘ç»œé”™è¯¯ï¼šè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–CORSé…ç½®';
                            } else {
                                errorMsg += error.message || 'æœªçŸ¥é”™è¯¯ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œé…ç½®';
                            }
                            
                            showOperationMessage(errorMsg, 'error');
                        }
                    };
                    
                    const testCustomDomainAccess = () => {
                        return new Promise((resolve) => {
                            if (!r2Config.customDomain) {
                                resolve();
                                return;
                            }
                            
                            const testImageUrl = `${r2Config.customDomain}yudong-fabric/test-image-${Date.now()}.jpg`;
                            const testImage = new Image();
                            
                            testImage.onload = function() {
                                console.log('è‡ªå®šä¹‰åŸŸåè®¿é—®æ­£å¸¸');
                                resolve();
                            };
                            
                            testImage.onerror = function() {
                                console.warn('è‡ªå®šä¹‰åŸŸåè®¿é—®å¯èƒ½æœ‰é—®é¢˜');
                                resolve();
                            };
                            
                            testImage.src = testImageUrl;
                        });
                    };
                    
                    // æ•°æ®å­˜å‚¨ç›¸å…³
                    const generateImageUrl = (productCode) => {
                        if (!r2Config.customDomain) {
                            console.warn('R2è‡ªå®šä¹‰åŸŸåæœªé…ç½®');
                            return null;
                        }
                        
                        const baseUrl = r2Config.customDomain.endsWith('/') ? 
                            r2Config.customDomain : r2Config.customDomain + '/';
                        
                        return `${baseUrl}yudong-fabric/${productCode}.jpg`;
                    };
                    
                    const uploadToR2 = (file, productCode) => {
                        return new Promise((resolve, reject) => {
                            if (!s3Client.value) {
                                reject(new Error('è¯·å…ˆé…ç½®Cloudflare R2'));
                                return;
                            }
                            
                            const key = `yudong-fabric/${productCode}.jpg`;
                            
                            s3Client.value.putObject({
                                Bucket: r2Config.bucket,
                                Key: key,
                                Body: file,
                                ContentType: 'image/jpeg'
                            }, function(err, data) {
                                if (err) {
                                    console.error('R2ä¸Šä¼ å¤±è´¥:', err);
                                    reject(err);
                                } else {
                                    console.log('R2ä¸Šä¼ æˆåŠŸ:', data);
                                    const imageUrl = generateImageUrl(productCode);
                                    console.log('ç”Ÿæˆçš„å›¾ç‰‡URL:', imageUrl);
                                    
                                    verifyImageAccess(imageUrl, productCode)
                                        .then(() => resolve(imageUrl))
                                        .catch(verifyErr => {
                                            console.warn('å›¾ç‰‡éªŒè¯å¤±è´¥ï¼Œä½†ç»§ç»­ä½¿ç”¨URL:', verifyErr);
                                            resolve(imageUrl);
                                        });
                                }
                            });
                        });
                    };
                    
                    const verifyImageAccess = (imageUrl, productCode) => {
                        return new Promise((resolve, reject) => {
                            const testImage = new Image();
                            testImage.onload = function() {
                                console.log(`âœ… å›¾ç‰‡ ${productCode} å¯æ­£å¸¸è®¿é—®`);
                                resolve();
                            };
                            testImage.onerror = function() {
                                console.error(`âŒ å›¾ç‰‡ ${productCode} æ— æ³•è®¿é—®ï¼Œè¯·æ£€æŸ¥R2å…¬å…±è®¿é—®è®¾ç½®`);
                                reject(new Error(`å›¾ç‰‡ ${productCode} æ— æ³•å…¬å¼€è®¿é—®`));
                            };
                            testImage.src = imageUrl + '?t=' + Date.now();
                        });
                    };
                    
                    const saveDataToR2 = async () => {
                        if (!s3Client.value) {
                            console.warn('R2æœªé…ç½®ï¼Œæ— æ³•ä¿å­˜æ•°æ®åˆ°äº‘ç«¯');
                            return;
                        }
                        
                        const dataToSave = {
                            catalogData: catalogData.value,
                            searchHistory: searchHistory.value,
                            saveTime: new Date().toISOString(),
                            version: '5.0-vue'
                        };
                        
                        const dataBlob = new Blob([JSON.stringify(dataToSave, null, 2)], { type: 'application/json' });
                        const key = 'yudong-cloud/database.json';
                        
                        try {
                            await s3Client.value.upload({
                                Bucket: r2Config.bucket,
                                Key: key,
                                Body: dataBlob,
                                ContentType: 'application/json'
                            }).promise();
                            
                            console.log('æ•°æ®å·²ä¿å­˜åˆ°R2');
                        } catch (error) {
                            console.error('ä¿å­˜æ•°æ®åˆ°R2å¤±è´¥:', error);
                            showOperationMessage('ä¿å­˜æ•°æ®åˆ°R2å¤±è´¥: ' + error.message, 'error');
                        }
                    };
                    
                    const loadDataFromR2 = async () => {
                        if (!s3Client.value) {
                            console.warn('R2æœªé…ç½®ï¼Œæ— æ³•ä»äº‘ç«¯åŠ è½½æ•°æ®');
                            return;
                        }
                        
                        try {
                            const data = await s3Client.value.getObject({
                                Bucket: r2Config.bucket,
                                Key: 'yudong-cloud/database.json'
                            }).promise();
                            
                            const dataToLoad = JSON.parse(data.Body.toString());
                            catalogData.value = dataToLoad.catalogData || {};
                            searchHistory.value = dataToLoad.searchHistory || [];
                            
                            console.log('æ•°æ®å·²ä»R2åŠ è½½');
                            showOperationMessage('æ•°æ®åŠ è½½æˆåŠŸ', 'success');
                        } catch (error) {
                            console.warn('ä»R2åŠ è½½æ•°æ®å¤±è´¥ï¼Œä½¿ç”¨ç©ºæ•°æ®:', error);
                            catalogData.value = {};
                            searchHistory.value = [];
                        }
                    };
                    
                    // æ•°æ®å¤‡ä»½ç›¸å…³ - ä¿®å¤ç‰ˆæœ¬
                    const exportAndUploadBackup = async () => {
                        if (Object.keys(catalogData.value).length === 0) {
                            showOperationMessage('æ— æ•°æ®å¯å¯¼å‡º', 'error');
                            return;
                        }
                        
                        showOperationMessage('æ­£åœ¨ç”Ÿæˆå¤‡ä»½æ–‡ä»¶...', 'loading');
                        
                        try {
                            const zip = new JSZip();
                            const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
                            
                            const fullData = {
                                catalogData: catalogData.value,
                                searchHistory: searchHistory.value,
                                exportTime: new Date().toISOString(),
                                version: '5.0-vue'
                            };
                            
                            zip.file('database.json', JSON.stringify(fullData, null, 2));
                            
                            try {
                                const rows = [['äº§å“ä»£ç ', 'ç ä»·', 'ç±³ä»·', 'é—¨å¹…', 'æˆåˆ†', 'å…‹é‡', 'å¤‡æ³¨', 'ä¾›åº”å•†']];
                                Object.values(catalogData.value).forEach(p => {
                                    rows.push([
                                        p.code || '-',
                                        p.price || '-',
                                        p.priceAlt || '-',
                                        p.width || '-',
                                        p.composition || '-',
                                        p.weight || '-',
                                        p.notes || '-',
                                        p.supplier || '-'
                                    ]);
                                });
                                
                                const wb = XLSX.utils.book_new();
                                const ws = XLSX.utils.aoa_to_sheet(rows);
                                XLSX.utils.book_append_sheet(wb, ws, 'äº§å“æ•°æ®');
                                const xlsxBuffer = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });
                                zip.file('äº§å“æ•°æ®è¡¨.xlsx', xlsxBuffer);
                            } catch (xlsxError) {
                                console.error('XLSX generation error:', xlsxError);
                            }
                            
                            const content = await zip.generateAsync({
                                type: 'blob',
                                compression: 'DEFLATE',
                                compressionOptions: { level: 6 }
                            });
                            
                            // ä¸‹è½½åˆ°æœ¬åœ°
                            const link = document.createElement('a');
                            link.href = URL.createObjectURL(content);
                            link.download = 'å®‡ä¸œçººç»‡å…¨åº“å¤‡ä»½_' + timestamp + '.zip';
                            link.click();
                            URL.revokeObjectURL(link.href);
                            
                            // ä¸Šä¼ åˆ°Cloudflare R2
                            try {
                                await uploadBackupToR2(content, link.download);
                                showOperationMessage('âœ… å®Œæ•´å¤‡ä»½å¯¼å‡ºæˆåŠŸï¼å·²åŒæ­¥åˆ°Cloudflare R2ã€‚', 'success');
                            } catch (error) {
                                console.error('å¤‡ä»½ä¸Šä¼ å¤±è´¥:', error);
                                showOperationMessage('âœ… å¤‡ä»½å¯¼å‡ºæˆåŠŸï¼Œä½†ä¸Šä¼ åˆ°R2å¤±è´¥: ' + error.message, 'warning');
                            }
                        } catch (error) {
                            console.error('ZIP generation error:', error);
                            showOperationMessage('å¯¼å‡ºå¤±è´¥ï¼š' + error.message, 'error');
                        }
                    };
                    
                    const uploadBackupToR2 = (backupBlob, fileName) => {
                        return new Promise((resolve, reject) => {
                            if (!s3Client.value) {
                                reject(new Error('è¯·å…ˆé…ç½®Cloudflare R2'));
                                return;
                            }
                            
                            const key = `yudong-cloud/${fileName}`;
                            
                            s3Client.value.upload({
                                Bucket: r2Config.bucket,
                                Key: key,
                                Body: backupBlob,
                                ContentType: 'application/zip'
                            }, function(err, data) {
                                if (err) {
                                    console.error('å¤‡ä»½ä¸Šä¼ å¤±è´¥:', err);
                                    reject(err);
                                } else {
                                    resolve(data);
                                }
                            });
                        });
                    };
                    
                    const loadR2BackupFiles = async () => {
                        console.log('åŠ è½½R2å¤‡ä»½æ–‡ä»¶');
                        if (!s3Client.value) {
                            showOperationMessage('è¯·å…ˆé…ç½®Cloudflare R2', 'error');
                            return;
                        }
                        
                        showOperationMessage('æ­£åœ¨åŠ è½½R2å¤‡ä»½æ–‡ä»¶...', 'loading');
                        
                        try {
                            const data = await s3Client.value.listObjectsV2({
                                Bucket: r2Config.bucket,
                                Prefix: 'yudong-cloud/'
                            }).promise();
                            
                            backupFiles.value = data.Contents.filter(item => 
                                item.Key.endsWith('.zip') && item.Key.startsWith('yudong-cloud/')
                            ).sort((a, b) => new Date(b.LastModified) - new Date(a.LastModified));
                            
                            showBackupFiles.value = true;
                            showOperationMessage(`æ‰¾åˆ° ${backupFiles.value.length} ä¸ªå¤‡ä»½æ–‡ä»¶`, 'success');
                        } catch (error) {
                            console.error('åŠ è½½å¤‡ä»½æ–‡ä»¶åˆ—è¡¨å¤±è´¥:', error);
                            showOperationMessage('åŠ è½½å¤‡ä»½æ–‡ä»¶åˆ—è¡¨å¤±è´¥: ' + error.message, 'error');
                        }
                    };
                    
                    const importFromR2Backup = async (fileKey) => {
                        if (!confirm('ç¡®å®šè¦ä»è¯¥å¤‡ä»½æ–‡ä»¶å¯¼å…¥æ•°æ®å—ï¼Ÿè¿™å°†è¦†ç›–å½“å‰æ‰€æœ‰æ•°æ®ã€‚')) {
                            return;
                        }
                        
                        showOperationMessage('æ­£åœ¨ä»R2å¤‡ä»½å¯¼å…¥æ•°æ®...', 'loading');
                        
                        try {
                            const data = await s3Client.value.getObject({
                                Bucket: r2Config.bucket,
                                Key: fileKey
                            }).promise();
                            
                            const blob = new Blob([data.Body], { type: 'application/zip' });
                            await importDatabase([new File([blob], fileKey.split('/').pop())]);
                        } catch (error) {
                            console.error('ä¸‹è½½å¤‡ä»½æ–‡ä»¶å¤±è´¥:', error);
                            showOperationMessage('ä¸‹è½½å¤‡ä»½æ–‡ä»¶å¤±è´¥: ' + error.message, 'error');
                        }
                    };
                    
                    const importDatabase = async (files) => {
                        if (files.length === 0) return;
                        const file = files[0];
                        
                        showOperationMessage('æ­£åœ¨å¯¼å…¥æ•°æ®åº“...', 'loading');
                        
                        try {
                            if (file.name.endsWith('.json')) {
                                const text = await readFileAsText(file);
                                const data = JSON.parse(text);
                                
                                if (data.catalogData) {
                                    catalogData.value = data.catalogData;
                                    searchHistory.value = data.searchHistory || [];
                                } else {
                                    catalogData.value = data;
                                }
                                
                                await saveDataToR2();
                                renderManageProducts();
                                showOperationMessage('âœ… æ•°æ®åº“å¯¼å…¥æˆåŠŸï¼', 'success');
                            } else if (file.name.endsWith('.zip')) {
                                const arrayBuffer = await readFileAsArrayBuffer(file);
                                const zip = await JSZip.loadAsync(arrayBuffer);
                                
                                const jsonFile = zip.file('database.json') || zip.file('æ•°æ®åº“å¤‡ä»½.json');
                                
                                if (jsonFile) {
                                    const jsonStr = await jsonFile.async('string');
                                    const data = JSON.parse(jsonStr);
                                    
                                    if (data.catalogData) {
                                        catalogData.value = data.catalogData;
                                        searchHistory.value = data.searchHistory || [];
                                    } else {
                                        catalogData.value = data;
                                    }
                                    
                                    await saveDataToR2();
                                    renderManageProducts();
                                    showOperationMessage('âœ… æ•°æ®åº“å¯¼å…¥æˆåŠŸï¼å…± ' + Object.keys(catalogData.value).length + ' æ¡æ•°æ®', 'success');
                                } else {
                                    showOperationMessage('å¯¼å…¥å¤±è´¥ï¼šZIPä¸­æœªæ‰¾åˆ°database.jsonæˆ–æ•°æ®åº“å¤‡ä»½.json', 'error');
                                }
                            } else {
                                showOperationMessage('ä¸æ”¯æŒçš„æ–‡ä»¶æ ¼å¼ï¼Œè¯·ä¸Šä¼ .jsonæˆ–.zipæ–‡ä»¶', 'error');
                            }
                        } catch (error) {
                            console.error('å¯¼å…¥å¤±è´¥:', error);
                            showOperationMessage('å¯¼å…¥å¤±è´¥ï¼š' + error.message, 'error');
                        }
                    };
                    
                    const readFileAsText = (file) => {
                        return new Promise((resolve, reject) => {
                            const reader = new FileReader();
                            reader.onload = e => resolve(e.target.result);
                            reader.onerror = () => reject(new Error('æ–‡ä»¶è¯»å–å¤±è´¥'));
                            reader.readAsText(file);
                        });
                    };
                    
                    const readFileAsArrayBuffer = (file) => {
                        return new Promise((resolve, reject) => {
                            const reader = new FileReader();
                            reader.onload = e => resolve(e.target.result);
                            reader.onerror = () => reject(new Error('æ–‡ä»¶è¯»å–å¤±è´¥'));
                            reader.readAsArrayBuffer(file);
                        });
                    };
                    
                    const clearData = async () => {
                        if (!confirm('âš ï¸ ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æ•°æ®å—ï¼Ÿ\n\næ­¤æ“ä½œå°†åˆ é™¤æ‰€æœ‰äº§å“æ•°æ®ï¼Œä¸”æ— æ³•æ¢å¤ï¼')) {
                            return;
                        }
                        
                        catalogData.value = {};
                        searchResults.value = [];
                        fuzzyMatches.value = [];
                        rangeResults.value = [];
                        
                        await saveDataToR2();
                        renderManageProducts();
                        showOperationMessage('æ‰€æœ‰æ•°æ®å·²æ¸…ç©º', 'success');
                    };
                    
                    // PDFå¯¼å‡º
                    const exportQuotePDF = () => {
                        const allResults = [];
                        if (rangeResults.value.length > 0) {
                            rangeResults.value.forEach(range => { 
                                range.matches.forEach(product => { allResults.push(product); }); 
                            });
                        } else {
                            searchResults.value.filter(r => r.found).forEach(r => allResults.push(r));
                        }
                        
                        if (allResults.length === 0) {
                            showOperationMessage('æ— ç»“æœå¯å¯¼å‡º', 'error');
                            return;
                        }
                        
                        showOperationMessage('æ­£åœ¨ç”ŸæˆæŠ¥ä»·PDF...', 'loading');
                        
                        const printContainer = document.createElement('div');
                        printContainer.id = 'pdf-content';
                        printContainer.style.cssText = 'position: absolute; left: -9999px; width: 250mm; font-family: "Microsoft YaHei", "å¾®è½¯é›…é»‘", sans-serif; background: white; padding: 15mm; line-height: 1.1;';
                        document.body.appendChild(printContainer);
                        
                        let html = '<h1 style="text-align: center; color: #40A891; font-size: 16pt; margin-bottom: 8mm; border-bottom: 2px solid #40A891; padding-bottom: 4mm;">ğŸ“Š å®‡ä¸œçººç»‡æŠ¥ä»·å•</h1>';
                        html += '<div style="text-align: center; color: #666; margin-bottom: 6mm; font-size: 8pt;">ç”Ÿæˆæ—¶é—´ï¼š' + new Date().toLocaleString('zh-CN') + ' | äº§å“æ•°é‡ï¼š' + allResults.length + ' é¡¹</div>';
                        html += '<table style="width: 100%; border-collapse: collapse; margin-bottom: 4mm; page-break-inside: auto; font-size: 7pt;">';
                        html += '<thead><tr style="page-break-inside: avoid; page-break-after: auto;">';
                        html += '<th style="width: 6%; background-color: #40A891; color: white; padding: 5pt 3pt; text-align: center; font-size: 8pt; border: 1px solid #333; font-weight: bold;">åºå·</th>';
                        html += '<th style="width: 14%; background-color: #40A891; color: white; padding: 5pt 3pt; text-align: center; font-size: 8pt; border: 1px solid #333; font-weight: bold;">äº§å“ä»£ç </th>';
                        html += '<th style="width: 9%; background-color: #40A891; color: white; padding: 5pt 3pt; text-align: center; font-size: 8pt; border: 1px solid #333; font-weight: bold;">ç ä»·</th>';
                        html += '<th style="width: 9%; background-color: #40A891; color: white; padding: 5pt 3pt; text-align: center; font-size: 8pt; border: 1px solid #333; font-weight: bold;">ç±³ä»·</th>';
                        html += '<th style="width: 9%; background-color: #40A891; color: white; padding: 5pt 3pt; text-align: center; font-size: 8pt; border: 1px solid #333; font-weight: bold;">é—¨å¹…</th>';
                        html += '<th style="width: 14%; background-color: #40A891; color: white; padding: 5pt 3pt; text-align: center; font-size: 8pt; border: 1px solid #333; font-weight: bold;">æˆåˆ†</th>';
                        html += '<th style="width: 9%; background-color: #40A891; color: white; padding: 5pt 3pt; text-align: center; font-size: 8pt; border: 1px solid #333; font-weight: bold;">å…‹é‡</th>';
                        html += '<th style="width: 20%; background-color: #40A891; color: white; padding: 5pt 3pt; text-align: center; font-size: 8pt; border: 1px solid #333; font-weight: bold;">å¤‡æ³¨</th>';
                        html += '</tr></thead><tbody>';
                        
                        allResults.forEach((product, index) => {
                            html += '<tr style="page-break-inside: avoid; page-break-after: auto; height: auto; min-height: 12pt;">';
                            html += '<td style="padding: 3pt 2pt; text-align: center; border: 1px solid #ddd; font-size: 7pt; vertical-align: middle;">' + (index + 1) + '</td>';
                            html += '<td style="padding: 3pt 2pt; text-align: center; border: 1px solid #ddd; font-size: 7pt; vertical-align: middle;"><strong>' + product.code + '</strong></td>';
                            html += '<td style="padding: 3pt 2pt; text-align: center; border: 1px solid #ddd; font-size: 7pt; vertical-align: middle;">' + product.price + '</td>';
                            html += '<td style="padding: 3pt 2pt; text-align: center; border: 1px solid #ddd; font-size: 7pt; vertical-align: middle;">' + product.priceAlt + '</td>';
                            html += '<td style="padding: 3pt 2pt; text-align: center; border: 1px solid #ddd; font-size: 7pt; vertical-align: middle;">' + product.width + '</td>';
                            html += '<td style="padding: 3pt 2pt; text-align: center; border: 1px solid #ddd; font-size: 7pt; vertical-align: middle; word-wrap: break-word;">' + product.composition + '</td>';
                            html += '<td style="padding: 3pt 2pt; text-align: center; border: 1px solid #ddd; font-size: 7pt; vertical-align: middle;">' + product.weight + '</td>';
                            html += '<td style="padding: 3pt 2pt; text-align: left; border: 1px solid #ddd; font-size: 6pt; vertical-align: top; color: #d32f2f; word-wrap: break-word; overflow-wrap: break-word; white-space: pre-wrap; line-height: 1.2; hyphens: auto; display: block;">' + (product.notes && product.notes !== '-' ? product.notes : '') + '</td>';
                            html += '</tr>';
                        });
                        
                        html += '</tbody></table>';
                        html += '<div style="text-align: center; color: #999; font-size: 6pt; margin-top: 8mm; border-top: 1px solid #ddd; padding-top: 4mm;">æœ¬æŠ¥ä»·å•ç”±å®‡ä¸œçººç»‡æŠ¥ä»·ç³»ç»Ÿç”Ÿæˆ | ç³»ç»Ÿç‰ˆæœ¬ï¼šv5.0-Vue</div>';
                        printContainer.innerHTML = html;
                        
                        html2canvas(printContainer, {
                            scale: 2,
                            useCORS: true,
                            allowTaint: true,
                            backgroundColor: '#ffffff',
                            width: printContainer.scrollWidth,
                            height: printContainer.scrollHeight,
                            logging: false
                        }).then(canvas => {
                            const { jsPDF } = window.jspdf;
                            const pdf = new jsPDF('l', 'mm', 'a4');
                            const pdfWidth = pdf.internal.pageSize.getWidth();
                            const pdfHeight = pdf.internal.pageSize.getHeight();
                            const imgWidth = pdfWidth - 30;
                            const pageHeight = pdfHeight - 30;
                            const imgHeight = (canvas.height * imgWidth) / canvas.width;
                            let heightLeft = imgHeight;
                            let position = 15;
                            
                            pdf.addImage(canvas.toDataURL('image/png'), 'PNG', 15, position, imgWidth, imgHeight);
                            heightLeft -= pageHeight;
                            
                            while (heightLeft >= 0) {
                                position = heightLeft - imgHeight + 15;
                                pdf.addPage();
                                pdf.addImage(canvas.toDataURL('image/png'), 'PNG', 15, position, imgWidth, imgHeight);
                                heightLeft -= pageHeight;
                            }
                            
                            pdf.save('æŠ¥ä»·å•_' + new Date().toISOString().slice(0, 10) + '.pdf');
                            showOperationMessage('âœ… PDFç”ŸæˆæˆåŠŸï¼', 'success');
                            document.body.removeChild(printContainer);
                        }).catch(error => {
                            console.error('PDF generation error:', error);
                            showOperationMessage('PDFç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
                            document.body.removeChild(printContainer);
                        });
                    };
                    
                    // åˆå§‹åŒ–
                    onMounted(() => {
                        // æ¨¡æ‹Ÿåˆå§‹åŒ–è¿‡ç¨‹
                        setTimeout(() => {
                            loadR2Config();
                            loading.value = false;
                            
                            // åˆå§‹åŒ–æ ‡ç­¾é¡µæ˜¾ç¤º
                            nextTick(() => {
                                const tabContents = document.querySelectorAll('.tab-content');
                                tabContents.forEach(content => {
                                    content.classList.remove('active');
                                });
                                
                                const activeContent = document.querySelector(`.tab-content[data-tab="${activeTab.value}"]`);
                                if (activeContent) {
                                    activeContent.classList.add('active');
                                }
                            });
                        }, 1000);
                    });
                    
                    // ç›‘å¬æœç´¢è¾“å…¥å˜åŒ–
                    watch(searchInput, (newValue) => {
                        if (newValue && Object.keys(catalogData.value).length > 0) {
                            handleSearch(newValue);
                        } else {
                            searchResults.value = [];
                            fuzzyMatches.value = [];
                            rangeResults.value = [];
                        }
                    });
                    
                    // ç›‘å¬æ ‡ç­¾é¡µå˜åŒ–
                    watch(activeTab, (newTab) => {
                        nextTick(() => {
                            const tabContents = document.querySelectorAll('.tab-content');
                            tabContents.forEach(content => {
                                content.classList.remove('active');
                            });
                            
                            const activeContent = document.querySelector(`.tab-content[data-tab="${newTab}"]`);
                            if (activeContent) {
                                activeContent.classList.add('active');
                            }
                        });
                    });
                    
                    return {
                        loading,
                        activeTab,
                        searchInput,
                        searchHistory,
                        catalogData,
                        searchResults,
                        fuzzyMatches,
                        rangeResults,
                        manageSearchTerm,
                        manageCurrentPage,
                        managePageSize,
                        filteredManageProducts,
                        hasMoreProducts,
                        editingProduct,
                        productForm,
                        r2Config,
                        s3Client,
                        imageModalVisible,
                        currentImage,
                        backupFiles,
                        operationMessage,
                        showBackupFiles,
                        stats,
                        storageStatus,
                        switchTab,
                        handleSearch,
                        loadHistory,
                        clearSearchHistory,
                        selectFuzzyMatch,
                        selectCode,
                        addOrUpdateProduct,
                        editProduct,
                        deleteProduct,
                        deleteProductFromList,
                        clearProductForm,
                        handleImageUpload,
                        showImage,
                        closeImageModal,
                        filterManageProducts,
                        renderManageProducts,
                        loadMoreProducts,
                        saveR2Config,
                        testR2Connection,
                        exportAndUploadBackup,
                        loadR2BackupFiles,
                        importFromR2Backup,
                        importDatabase,
                        clearData,
                        exportQuotePDF
                    };
                },
                
                template: `
                <div class="min-h-screen bg-gray-50 mobile-optimized">
                    <!-- åŠ è½½çŠ¶æ€ -->
                    <div v-if="loading" class="fixed inset-0 bg-white bg-opacity-80 flex items-center justify-center z-50">
                        <div class="text-center">
                            <div class="inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-green-500"></div>
                            <p class="mt-4 text-gray-600">ç³»ç»Ÿåˆå§‹åŒ–ä¸­...</p>
                        </div>
                    </div>
                    
                    <!-- ä¸»è¦å†…å®¹ -->
                    <div v-if="!loading" class="min-h-screen bg-gray-50 mobile-optimized">
                        <!-- é¡¶éƒ¨ Header -->
                        <div class="gradient-bg text-white shadow-lg header-section">
                            <div class="container mx-auto px-4 py-6">
                                <div class="text-center mb-4">
                                    <h1 class="text-2xl md:text-3xl font-bold mb-2">ğŸ“Š å®‡ä¸œçººç»‡æŠ¥ä»·ç³»ç»Ÿ</h1>
                                    <p class="text-sm md:text-base opacity-90">æ™ºèƒ½æŸ¥è¯¢ Â· æ•°æ®ç®¡ç† Â· ä¸“ä¸šæŠ¥ä»·</p>
                                </div>
                                
                                <!-- ç»Ÿè®¡å¡ç‰‡ -->
                                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-2 mb-4">
                                    <div class="stat-card rounded-lg p-3 text-center">
                                        <div class="text-xl font-bold">{{ stats.totalProducts }}</div>
                                        <div class="text-xs opacity-90">äº§å“æ€»æ•°</div>
                                    </div>
                                    <div class="stat-card rounded-lg p-3 text-center">
                                        <div class="text-xl font-bold">{{ stats.r2Images }}</div>
                                        <div class="text-xs opacity-90">R2å›¾ç‰‡</div>
                                    </div>
                                    <div class="stat-card rounded-lg p-3 text-center">
                                        <div class="text-xl font-bold">{{ stats.localImages }}</div>
                                        <div class="text-xs opacity-90">æœ¬åœ°å›¾ç‰‡</div>
                                    </div>
                                    <div class="stat-card rounded-lg p-3 text-center">
                                        <div class="text-xl font-bold">{{ stats.missingImages }}</div>
                                        <div class="text-xs opacity-90">ç¼ºå¤±å›¾ç‰‡</div>
                                    </div>
                                    <div class="stat-card rounded-lg p-3 text-center">
                                        <div class="text-xl font-bold">{{ stats.storageUsage }}</div>
                                        <div class="text-xs opacity-90">å­˜å‚¨ç”¨é‡</div>
                                    </div>
                                    <div class="stat-card rounded-lg p-3 text-center">
                                        <div class="text-xl font-bold">{{ stats.systemHealth }}</div>
                                        <div class="text-xs opacity-90">ç³»ç»Ÿå¥åº·</div>
                                    </div>
                                </div>
                                
                                <!-- å­˜å‚¨çŠ¶æ€ -->
                                <div class="flex flex-col md:flex-row justify-between items-center bg-white bg-opacity-15 rounded-lg p-3 text-sm">
                                    <div class="flex items-center space-x-2 mb-2 md:mb-0">
                                        <span>ğŸ’¾ å­˜å‚¨åˆ†å¸ƒ:</span>
                                        <span class="px-2 py-1 rounded-full bg-yellow-500 bg-opacity-20 text-yellow-300 text-xs">æœ¬åœ°: {{ stats.localImages }}</span>
                                        <span class="px-2 py-1 rounded-full bg-green-500 bg-opacity-20 text-green-300 text-xs">R2: {{ stats.r2Images }}</span>
                                    </div>
                                    <div>
                                        <span>{{ s3Client ? 'âœ… äº‘ç«¯åŒæ­¥' : 'âš ï¸ ä»…æœ¬åœ°' }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- æ ‡ç­¾é¡µå¯¼èˆª -->
                        <div class="container mx-auto px-4 main-content relative z-10">
                            <div class="bg-white rounded-xl shadow-lg overflow-hidden tab-container performance-optimized">
                                <!-- æ ‡ç­¾é¡µæŒ‰é’® -->
                                <div class="tab-buttons">
                                    <button 
                                        @click="switchTab('query')"
                                        :class="{'tab-button active text-white': activeTab === 'query', 'tab-button text-gray-600': activeTab !== 'query'}"
                                        class="no-tap-delay"
                                    >
                                        ğŸ” æŸ¥è¯¢æŠ¥ä»·
                                    </button>
                                    <button 
                                        @click="switchTab('manage')"
                                        :class="{'tab-button active text-white': activeTab === 'manage', 'tab-button text-gray-600': activeTab !== 'manage'}"
                                        class="no-tap-delay"
                                    >
                                        ğŸ› ï¸ äº§å“ç®¡ç†
                                    </button>
                                    <button 
                                        @click="switchTab('data')"
                                        :class="{'tab-button active text-white': activeTab === 'data', 'tab-button text-gray-600': activeTab !== 'data'}"
                                        class="no-tap-delay"
                                    >
                                        ğŸ“¦ æ•°æ®å¤‡ä»½
                                    </button>
                                </div>
                                
                                <!-- æ ‡ç­¾é¡µå†…å®¹ -->
                                <div class="p-6">
                                    <!-- æŸ¥è¯¢æŠ¥ä»· -->
                                    <div class="tab-content" data-tab="query" :class="{ active: activeTab === 'query' }">
                                        <div class="space-y-6">
                                            <h2 class="text-xl font-bold text-gray-800 border-b pb-2">äº§å“æ™ºèƒ½æŸ¥è¯¢</h2>
                                            
                                            <div class="relative">
                                                <textarea 
                                                    v-model="searchInput" 
                                                    class="w-full p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" 
                                                    rows="4" 
                                                    placeholder="è¾“å…¥äº§å“ä»£ç ã€ä¾›åº”å•†æˆ–ä»·æ ¼/å…‹é‡åŒºé—´...

ç¤ºä¾‹ï¼š
â€¢ äº§å“ä»£ç ï¼šC6001, Y6
â€¢ ä¾›åº”å•†ï¼šæ°¸è”
â€¢ ä»·æ ¼åŒºé—´ï¼š20å…ƒä»¥ä¸Š, 10-15å…ƒ
â€¢ å…‹é‡åŒºé—´ï¼š100å…‹å†…, 150-200å…‹"
                                                ></textarea>
                                            </div>
                                            
                                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                                <p class="text-blue-800">
                                                    ğŸ’¡ å®æ—¶æ™ºèƒ½æœç´¢å·²å¼€å¯ï¼šè¾“å…¥å³è‡ªåŠ¨åŒ¹é…äº§å“ä»£ç ã€ä¾›åº”å•†ã€ä»·æ ¼/å…‹é‡åŒºé—´ã€‚æ”¯æŒæ‰¹é‡æŸ¥è¯¢ã€æ¨¡ç³Šæœç´¢ä¸å†å²è®°å½•å¿«é€Ÿè°ƒç”¨ã€‚
                                                </p>
                                            </div>
                                            
                                            <!-- æœç´¢å†å² -->
                                            <div>
                                                <h3 class="text-lg font-semibold text-gray-700 mb-2">âŒš æœç´¢å†å²</h3>
                                                <div class="flex flex-wrap gap-2">
                                                    <span 
                                                        v-for="(item, index) in searchHistory.slice(-5).reverse()" 
                                                        :key="index"
                                                        class="px-3 py-1 bg-gray-100 rounded-full text-sm cursor-pointer hover:bg-green-500 hover:text-white transition-colors no-tap-delay"
                                                        @click="loadHistory(item)"
                                                    >
                                                        {{ item }}
                                                    </span>
                                                </div>
                                            </div>
                                            
                                            <div class="flex flex-wrap gap-3">
                                                <button 
                                                    class="px-4 py-2 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed action-button no-tap-delay"
                                                    :disabled="searchResults.length === 0 && rangeResults.length === 0"
                                                    @click="exportQuotePDF"
                                                >
                                                    ğŸ“„ å¯¼å‡ºæŠ¥ä»·PDF
                                                </button>
                                                <button 
                                                    class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors action-button no-tap-delay"
                                                    @click="clearSearchHistory"
                                                >
                                                    ğŸ—‘ï¸ æ¸…é™¤å†å²
                                                </button>
                                            </div>
                                            
                                            <!-- æœç´¢ç»“æœ -->
                                            <div class="mt-6 space-y-4">
                                                <!-- æœç´¢ç»“æœç»Ÿè®¡ -->
                                                <div v-if="searchResults.length > 0" class="bg-green-50 border border-green-200 rounded-lg p-4">
                                                    <p class="text-green-800">
                                                        ğŸ“Š å…±æŸ¥è¯¢ <strong>{{ searchResults.length }}</strong> ä¸ªäº§å“ï¼Œæ‰¾åˆ° 
                                                        <strong>{{ searchResults.filter(r => r.found).length }}</strong> ä¸ªåŒ¹é…ç»“æœ
                                                    </p>
                                                </div>
                                                
                                                <!-- æ¨¡ç³ŠåŒ¹é…ç»“æœ -->
                                                <div v-for="fuzzy in fuzzyMatches" :key="fuzzy.searchTerm" class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                                    <p class="text-yellow-800 font-semibold mb-2">
                                                        ğŸ” æ¨¡ç³Šæœç´¢ "{{ fuzzy.searchTerm }}" æ‰¾åˆ° {{ fuzzy.matches.length }} ä¸ªåŒ¹é…
                                                    </p>
                                                    <div class="flex flex-wrap gap-2">
                                                        <span
                                                            v-for="match in fuzzy.matches"
                                                            :key="match"
                                                            class="px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm cursor-pointer hover:bg-yellow-500 hover:text-white transition-colors no-tap-delay"
                                                            @click="selectFuzzyMatch(match)"
                                                        >
                                                            {{ match }}
                                                        </span>
                                                    </div>
                                                </div>
                                                
                                                <!-- åŒºé—´æŸ¥è¯¢ç»“æœ -->
                                                <div v-for="range in rangeResults" :key="range.label" class="border border-gray-200 rounded-lg overflow-hidden">
                                                    <div class="bg-green-50 p-4 border-b border-green-200 flex justify-between items-center">
                                                        <span class="text-green-800 font-semibold">{{ range.label }}</span>
                                                        <span class="px-2 py-1 bg-green-500 text-white rounded-full text-xs font-semibold">
                                                            åŒ¹é… {{ range.matches.length }} ä¸ªäº§å“
                                                        </span>
                                                    </div>
                                                    
                                                    <div v-if="range.matches.length > 0" class="p-4">
                                                        <h4 class="text-sm font-semibold text-gray-600 mb-3">
                                                            ğŸ“‹ åŒ¹é…äº§å“ç¼–å· ({{ range.matches.length }} ä¸ª)
                                                        </h4>
                                                        <div class="flex flex-wrap gap-2 mb-4">
                                                            <span
                                                                v-for="product in range.matches"
                                                                :key="product.code"
                                                                class="px-3 py-1 bg-gray-100 rounded-full text-sm cursor-pointer hover:bg-green-500 hover:text-white transition-colors no-tap-delay"
                                                                @click="selectCode(product.code)"
                                                            >
                                                                {{ product.code }}
                                                            </span>
                                                        </div>
                                                        
                                                        <!-- äº§å“å¡ç‰‡ -->
                                                        <div class="space-y-4">
                                                            <div 
                                                                v-for="product in range.matches" 
                                                                :key="product.code"
                                                                class="product-card bg-white border border-gray-200 rounded-lg overflow-hidden"
                                                            >
                                                                <div class="bg-gray-50 p-4 border-b border-gray-200 flex justify-between items-center">
                                                                    <span class="text-lg font-bold text-green-700">ğŸ“¦ {{ product.code }}</span>
                                                                    <span class="px-2 py-1 bg-green-500 text-white rounded-full text-xs font-semibold">
                                                                        ğŸ“Š åŒºé—´åŒ¹é…
                                                                    </span>
                                                                </div>
                                                                
                                                                <div class="p-4">
                                                                    <div class="grid grid-cols-2 gap-4 mb-4">
                                                                        <div>
                                                                            <label class="text-xs text-gray-500">ğŸ’° ç ä»· (Y)</label>
                                                                            <div class="font-bold">{{ product.price }}</div>
                                                                        </div>
                                                                        <div>
                                                                            <label class="text-xs text-gray-500">ğŸ’° ç±³ä»· (M)</label>
                                                                            <div class="font-bold">{{ product.priceAlt }}</div>
                                                                        </div>
                                                                        <div>
                                                                            <label class="text-xs text-gray-500">ğŸ“ é—¨å¹…</label>
                                                                            <div class="font-semibold">{{ product.width }}</div>
                                                                        </div>
                                                                        <div>
                                                                            <label class="text-xs text-gray-500">âš–ï¸ å…‹é‡</label>
                                                                            <div class="font-semibold">{{ product.weight }}</div>
                                                                        </div>
                                                                        <div class="col-span-2">
                                                                            <label class="text-xs text-gray-500">ğŸ§µ æˆåˆ†</label>
                                                                            <div class="font-semibold">{{ product.composition }}</div>
                                                                        </div>
                                                                    </div>
                                                                    
                                                                    <div v-if="product.notes && product.notes !== '-'" class="bg-red-50 border border-red-200 rounded p-3 mb-4">
                                                                        <div class="font-bold text-red-700 mb-1">âš ï¸ å¤‡æ³¨</div>
                                                                        <div class="text-red-600">{{ product.notes }}</div>
                                                                    </div>
                                                                    
                                                                    <div class="bg-gray-50 rounded p-3 flex items-center justify-between">
                                                                        <div class="flex items-center space-x-3">
                                                                            <span class="text-sm text-gray-600">ğŸ­ ä¾›åº”å•†</span>
                                                                            <span class="font-semibold">{{ product.supplier && product.supplier !== '-' ? product.supplier : 'æš‚æ— ä¿¡æ¯' }}</span>
                                                                        </div>
                                                                        
                                                                        <button 
                                                                            v-if="product.image"
                                                                            class="px-3 py-1 bg-green-500 text-white rounded text-sm font-semibold hover:bg-green-600 transition-colors action-button no-tap-delay"
                                                                            @click="showImage(product.image, product.code)"
                                                                        >
                                                                            æŸ¥çœ‹åº•å¡
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                    <div v-else class="p-8 text-center">
                                                        <div class="text-4xl text-gray-300 mb-2">ğŸ”</div>
                                                        <div class="text-gray-500">æš‚æ— åŒ¹é…äº§å“</div>
                                                        <div class="text-sm text-gray-400">è¯¥åŒºé—´å†…æ²¡æœ‰æ‰¾åˆ°äº§å“</div>
                                                    </div>
                                                </div>
                                                
                                                <!-- ç²¾ç¡®åŒ¹é…ç»“æœ -->
                                                <div class="space-y-4">
                                                    <div 
                                                        v-for="result in searchResults" 
                                                        :key="result.code"
                                                        class="product-card bg-white border border-gray-200 rounded-lg overflow-hidden"
                                                    >
                                                        <div v-if="result.found">
                                                            <div class="bg-gray-50 p-4 border-b border-gray-200 flex justify-between items-center">
                                                                <span class="text-lg font-bold text-green-700">ğŸ“¦ {{ result.code }}</span>
                                                                <span 
                                                                    :class="{'bg-green-500': result.matchType === 'exact', 'bg-blue-500': result.matchType === 'fuzzy'}"
                                                                    class="px-2 py-1 text-white rounded-full text-xs font-semibold"
                                                                >
                                                                    {{ result.matchType === 'exact' ? 'âœ“ ç²¾ç¡®åŒ¹é…' : 'ğŸ¯ æ¨¡ç³ŠåŒ¹é…' }}
                                                                </span>
                                                            </div>
                                                            
                                                            <div class="p-4">
                                                                <div class="grid grid-cols-2 gap-4 mb-4">
                                                                    <div>
                                                                        <label class="text-xs text-gray-500">ğŸ’° ç ä»· (Y)</label>
                                                                        <div class="font-bold">{{ result.price }}</div>
                                                                    </div>
                                                                    <div>
                                                                        <label class="text-xs text-gray-500">ğŸ’° ç±³ä»· (M)</label>
                                                                        <div class="font-bold">{{ result.priceAlt }}</div>
                                                                    </div>
                                                                    <div>
                                                                        <label class="text-xs text-gray-500">ğŸ“ é—¨å¹…</label>
                                                                        <div class="font-semibold">{{ result.width }}</div>
                                                                    </div>
                                                                    <div>
                                                                        <label class="text-xs text-gray-500">âš–ï¸ å…‹é‡</label>
                                                                        <div class="font-semibold">{{ result.weight }}</div>
                                                                    </div>
                                                                    <div class="col-span-2">
                                                                        <label class="text-xs text-gray-500">ğŸ§µ æˆåˆ†</label>
                                                                        <div class="font-semibold">{{ result.composition }}</div>
                                                                    </div>
                                                                </div>
                                                                
                                                                <div v-if="result.notes && result.notes !== '-'" class="bg-red-50 border border-red-200 rounded p-3 mb-4">
                                                                    <div class="font-bold text-red-700 mb-1">âš ï¸ å¤‡æ³¨</div>
                                                                    <div class="text-red-600">{{ result.notes }}</div>
                                                                </div>
                                                                
                                                                <div class="bg-gray-50 rounded p-3 flex items-center justify-between">
                                                                    <div class="flex items-center space-x-3">
                                                                        <span class="text-sm text-gray-600">ğŸ­ ä¾›åº”å•†</span>
                                                                        <span class="font-semibold">{{ result.supplier && result.supplier !== '-' ? result.supplier : 'æš‚æ— ä¿¡æ¯' }}</span>
                                                                    </div>
                                                                    
                                                                    <button 
                                                                        v-if="result.image"
                                                                        class="px-3 py-1 bg-green-500 text-white rounded text-sm font-semibold hover:bg-green-600 transition-colors action-button no-tap-delay"
                                                                        @click="showImage(result.image, result.code)"
                                                                    >
                                                                        æŸ¥çœ‹åº•å¡
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        
                                                        <div v-else class="p-8 text-center">
                                                            <div class="text-4xl text-red-300 mb-2">âŒ</div>
                                                            <div class="text-lg font-bold text-red-500">{{ result.code }}</div>
                                                            <div class="text-red-400">{{ result.error }}</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- äº§å“ç®¡ç† -->
                                    <div class="tab-content" data-tab="manage" :class="{ active: activeTab === 'manage' }">
                                        <div class="space-y-6">
                                            <h2 class="text-xl font-bold text-gray-800 border-b pb-2">äº§å“æ•°æ®ç»´æŠ¤</h2>
                                            
                                            <!-- å­˜å‚¨çŠ¶æ€è­¦å‘Š -->
                                            <div v-if="storageStatus" :class="{'bg-red-50 border-red-200 text-red-700': storageStatus.type === 'error', 'bg-yellow-50 border-yellow-200 text-yellow-700': storageStatus.type === 'warning'}" class="border rounded-lg p-4">
                                                <div class="flex items-center">
                                                    <span class="mr-2">{{ storageStatus.type === 'error' ? 'âš ï¸' : 'ğŸ’¾' }}</span>
                                                    <span>{{ storageStatus.message }}</span>
                                                </div>
                                            </div>
                                            
                                            <!-- æ·»åŠ /ç¼–è¾‘äº§å“è¡¨å• -->
                                            <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden edit-form-container" id="edit-product-form">
                                                <div class="bg-gray-50 p-4 border-b border-gray-200">
                                                    <h3 class="text-lg font-bold text-green-700">â• æ·»åŠ /ç¼–è¾‘äº§å“</h3>
                                                </div>
                                                
                                                <div class="p-4">
                                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                        <div>
                                                            <label class="block text-sm font-medium text-gray-700 mb-1">äº§å“ä»£ç  <span class="text-red-500">*</span></label>
                                                            <input 
                                                                v-model="productForm.code" 
                                                                type="text" 
                                                                class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                                placeholder="ä¾‹å¦‚ï¼šC6001, YC2001"
                                                            >
                                                        </div>
                                                        <div>
                                                            <label class="block text-sm font-medium text-gray-700 mb-1">ç ä»·</label>
                                                            <input 
                                                                v-model="productForm.price" 
                                                                type="text" 
                                                                class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                                placeholder="ä¾‹å¦‚ï¼š12.5å…ƒ/ç "
                                                            >
                                                        </div>
                                                        <div>
                                                            <label class="block text-sm font-medium text-gray-700 mb-1">ç±³ä»·</label>
                                                            <input 
                                                                v-model="productForm.priceAlt" 
                                                                type="text" 
                                                                class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                                placeholder="ä¾‹å¦‚ï¼š12.5å…ƒ/ç±³-è¶³ç±³"
                                                            >
                                                        </div>
                                                        <div>
                                                            <label class="block text-sm font-medium text-gray-700 mb-1">é—¨å¹…</label>
                                                            <input 
                                                                v-model="productForm.width" 
                                                                type="text" 
                                                                class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                                placeholder="ä¾‹å¦‚ï¼š150cm"
                                                            >
                                                        </div>
                                                        <div>
                                                            <label class="block text-sm font-medium text-gray-700 mb-1">æˆåˆ†</label>
                                                            <input 
                                                                v-model="productForm.composition" 
                                                                type="text" 
                                                                class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                                placeholder="ä¾‹å¦‚ï¼š100é”¦çº¶"
                                                            >
                                                        </div>
                                                        <div>
                                                            <label class="block text-sm font-medium text-gray-700 mb-1">å…‹é‡</label>
                                                            <input 
                                                                v-model="productForm.weight" 
                                                                type="text" 
                                                                class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                                placeholder="ä¾‹å¦‚ï¼š90å…‹/å¹³æ–¹ï¼ˆgsmï¼‰"
                                                            >
                                                        </div>
                                                        <div class="md:col-span-2">
                                                            <label class="block text-sm font-medium text-gray-700 mb-1">å¤‡æ³¨</label>
                                                            <input 
                                                                v-model="productForm.notes" 
                                                                type="text" 
                                                                class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                                placeholder="ä¾‹å¦‚ï¼šé¢œè‰²ä»·æ ¼è¯´æ˜ç­‰"
                                                            >
                                                        </div>
                                                        <div class="md:col-span-2">
                                                            <label class="block text-sm font-medium text-gray-700 mb-1">ä¾›åº”å•†</label>
                                                            <input 
                                                                v-model="productForm.supplier" 
                                                                type="text" 
                                                                class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                                placeholder="ä¾‹å¦‚ï¼šå‡¯æ³“K5ã€KH86ã€‘"
                                                            >
                                                        </div>
                                                        
                                                        <!-- å›¾ç‰‡ä¸Šä¼  -->
                                                        <div class="md:col-span-2">
                                                            <label class="block text-sm font-medium text-gray-700 mb-1">åº•å¡å›¾ç‰‡</label>
                                                            <input 
                                                                type="file" 
                                                                @change="handleImageUpload"
                                                                class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                                accept="image/*"
                                                            >
                                                            <p class="text-xs text-gray-500 mt-1">æ”¯æŒ JPG/PNG æ ¼å¼ï¼Œå¤§å°ä¸è¶…è¿‡ 5MB</p>
                                                            <div v-if="productForm.imageFile" class="mt-2 text-sm text-green-600">
                                                                å·²é€‰æ‹©: {{ productForm.imageFile.name }}
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                    <div class="flex flex-wrap gap-3 mt-6">
                                                        <button 
                                                            v-if="!editingProduct" 
                                                            class="px-4 py-2 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition-colors action-button no-tap-delay"
                                                            @click="addOrUpdateProduct"
                                                        >
                                                            æ·»åŠ äº§å“
                                                        </button>
                                                        <button 
                                                            v-if="editingProduct" 
                                                            class="px-4 py-2 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition-colors action-button no-tap-delay"
                                                            @click="addOrUpdateProduct"
                                                        >
                                                            æ›´æ–°äº§å“
                                                        </button>
                                                        <button 
                                                            v-if="editingProduct" 
                                                            class="px-4 py-2 bg-red-500 text-white rounded-lg font-semibold hover:bg-red-600 transition-colors action-button no-tap-delay"
                                                            @click="deleteProduct"
                                                        >
                                                            åˆ é™¤äº§å“
                                                        </button>
                                                        <button 
                                                            class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-colors action-button no-tap-delay"
                                                            @click="clearProductForm"
                                                        >
                                                            æ¸…ç©ºè¡¨å•
                                                        </button>
                                                    </div>
                                                    
                                                    <!-- æ“ä½œåé¦ˆ -->
                                                    <div v-if="operationMessage.text" :class="{'bg-green-50 text-green-700': operationMessage.type === 'success', 'bg-red-50 text-red-700': operationMessage.type === 'error', 'bg-blue-50 text-blue-700': operationMessage.type === 'loading'}" class="mt-4 p-3 rounded">
                                                        {{ operationMessage.text }}
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- äº§å“åˆ—è¡¨ -->
                                            <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden">
                                                <div class="bg-gray-50 p-4 border-b border-gray-200">
                                                    <h3 class="text-lg font-bold text-green-700">ğŸ” äº§å“åˆ—è¡¨ä¸æœç´¢</h3>
                                                </div>
                                                
                                                <div class="p-4">
                                                    <div class="mb-4">
                                                        <input
                                                            v-model="manageSearchTerm"
                                                            type="text"
                                                            class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                            placeholder="æœç´¢äº§å“ä»£ç æˆ–ä¾›åº”å•†..."
                                                        >
                                                    </div>
                                                    
                                                    <div class="space-y-4">
                                                        <div 
                                                            v-for="code in renderManageProducts()" 
                                                            :key="code"
                                                            class="product-card bg-white border border-gray-200 rounded-lg overflow-hidden"
                                                        >
                                                            <div class="p-4 border-b border-gray-200">
                                                                <div class="flex justify-between items-center">
                                                                    <span class="text-lg font-bold text-green-700">ğŸ“¦ {{ code }}</span>
                                                                    <div class="flex space-x-2">
                                                                        <button 
                                                                            class="px-3 py-1 bg-blue-500 text-white rounded text-sm font-semibold hover:bg-blue-600 transition-colors action-button no-tap-delay"
                                                                            @click="editProduct(code)"
                                                                        >
                                                                            ç¼–è¾‘
                                                                        </button>
                                                                        <button 
                                                                            class="px-3 py-1 bg-red-500 text-white rounded text-sm font-semibold hover:bg-red-600 transition-colors action-button no-tap-delay"
                                                                            @click="deleteProductFromList(code)"
                                                                        >
                                                                            åˆ é™¤
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            
                                                            <div class="p-4">
                                                                <div class="grid grid-cols-2 gap-4 mb-4">
                                                                    <div class="text-center">
                                                                        <label class="text-xs text-gray-500">ğŸ’° ç ä»·</label>
                                                                        <div class="font-bold">{{ catalogData[code].price }}</div>
                                                                    </div>
                                                                    <div class="text-center">
                                                                        <label class="text-xs text-gray-500">ğŸ’° ç±³ä»·</label>
                                                                        <div class="font-bold">{{ catalogData[code].priceAlt }}</div>
                                                                    </div>
                                                                    <div class="text-center">
                                                                        <label class="text-xs text-gray-500">ğŸ“ é—¨å¹…</label>
                                                                        <div class="font-semibold">{{ catalogData[code].width }}</div>
                                                                    </div>
                                                                    <div class="text-center">
                                                                        <label class="text-xs text-gray-500">âš–ï¸ å…‹é‡</label>
                                                                        <div class="font-semibold">{{ catalogData[code].weight }}</div>
                                                                    </div>
                                                                    <div class="col-span-2 text-center">
                                                                        <label class="text-xs text-gray-500">ğŸ§µ æˆåˆ†</label>
                                                                        <div class="font-semibold">{{ catalogData[code].composition }}</div>
                                                                    </div>
                                                                    <div class="col-span-2 text-center">
                                                                        <label class="text-xs text-gray-500">ğŸ­ ä¾›åº”å•†</label>
                                                                        <div class="font-semibold">{{ catalogData[code].supplier }}</div>
                                                                    </div>
                                                                </div>
                                                                
                                                                <div v-if="catalogData[code].notes && catalogData[code].notes !== '-'" class="bg-red-50 border border-red-200 rounded p-3 mb-4">
                                                                    <div class="text-red-700">{{ catalogData[code].notes }}</div>
                                                                </div>
                                                                
                                                                <div class="flex justify-center">
                                                                    <div 
                                                                        v-if="catalogData[code].image"
                                                                        class="cursor-pointer"
                                                                        @click="showImage(catalogData[code].image, code)"
                                                                    >
                                                                        <img 
                                                                            :src="catalogData[code].image" 
                                                                            :alt="'äº§å“ ' + code + ' åº•å¡å›¾ç‰‡'"
                                                                            class="w-20 h-20 object-cover rounded border border-gray-200 image-preview"
                                                                            @error="e => e.target.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2YwZjBmMCIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGZpbGw9IiM5OTkiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj7lm77niYc8L3RleHQ+PC9zdmc+'"
                                                                        />
                                                                    </div>
                                                                    <div v-else class="w-20 h-20 bg-gray-100 rounded border border-gray-200 flex items-center justify-center text-gray-400 text-xs text-center">
                                                                        æ— å›¾ç‰‡
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        
                                                        <div v-if="renderManageProducts().length === 0" class="text-center p-8 bg-white rounded-lg border border-gray-200">
                                                            <div class="text-4xl text-gray-300 mb-2">ğŸ“¦</div>
                                                            <div class="text-gray-500">æš‚æ— äº§å“</div>
                                                            <div class="text-sm text-gray-400">é€šè¿‡ä¸Šæ–¹è¡¨å•æ·»åŠ æˆ–ä¸Šä¼ æ–‡ä»¶å¯¼å…¥</div>
                                                        </div>
                                                        
                                                        <div v-if="hasMoreProducts" class="text-center mt-4">
                                                            <button 
                                                                class="px-4 py-2 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition-colors action-button no-tap-delay"
                                                                @click="loadMoreProducts"
                                                            >
                                                                åŠ è½½æ›´å¤š
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- æ•°æ®å¤‡ä»½ -->
                                    <div class="tab-content" data-tab="data" :class="{ active: activeTab === 'data' }">
                                        <div class="space-y-6">
                                            <h2 class="text-xl font-bold text-gray-800 border-b pb-2">æ•°æ®å¤‡ä»½</h2>
                                            
                                            <!-- Cloudflare R2é…ç½® -->
                                            <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                                <h3 class="text-lg font-bold text-green-700 mb-4">â˜ï¸ Cloudflare R2 + è‡ªå®šä¹‰åŸŸåé…ç½®</h3>
                                                
                                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                                    <div>
                                                        <label class="block text-sm font-medium text-gray-700 mb-1">Account ID</label>
                                                        <input 
                                                            v-model="r2Config.accountId" 
                                                            type="text" 
                                                            class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                            placeholder="è¯·è¾“å…¥Cloudflare Account ID"
                                                        >
                                                    </div>
                                                    <div>
                                                        <label class="block text-sm font-medium text-gray-700 mb-1">Access Key ID</label>
                                                        <input 
                                                            v-model="r2Config.accessKey" 
                                                            type="text" 
                                                            class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                            placeholder="è¯·è¾“å…¥R2 Access Key ID"
                                                        >
                                                    </div>
                                                    <div>
                                                        <label class="block text-sm font-medium text-gray-700 mb-1">Secret Access Key</label>
                                                        <input 
                                                            v-model="r2Config.secretKey" 
                                                            type="password" 
                                                            class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                            placeholder="è¯·è¾“å…¥R2 Secret Access Key"
                                                        >
                                                    </div>
                                                    <div>
                                                        <label class="block text-sm font-medium text-gray-700 mb-1">Bucket åç§°</label>
                                                        <input 
                                                            v-model="r2Config.bucket" 
                                                            type="text" 
                                                            class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                            placeholder="è¯·è¾“å…¥å­˜å‚¨æ¡¶åç§°"
                                                        >
                                                    </div>
                                                    <div class="md:col-span-2">
                                                        <label class="block text-sm font-medium text-gray-700 mb-1">è‡ªå®šä¹‰åŸŸå</label>
                                                        <input 
                                                            v-model="r2Config.customDomain" 
                                                            type="text" 
                                                            class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-green-500"
                                                            placeholder="https://img.yudong-textile.top"
                                                        >
                                                    </div>
                                                </div>
                                                
                                                <div class="button-group">
                                                    <button 
                                                        class="px-4 py-2 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition-colors action-button no-tap-delay"
                                                        @click="saveR2Config"
                                                    >
                                                        ä¿å­˜é…ç½®
                                                    </button>
                                                    <button 
                                                        class="px-4 py-2 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition-colors action-button no-tap-delay"
                                                        @click="testR2Connection"
                                                    >
                                                        æµ‹è¯•è¿æ¥
                                                    </button>
                                                </div>
                                                
                                                <div class="bg-blue-50 border border-blue-200 rounded p-3 mt-4">
                                                    <p class="text-blue-800">
                                                        ğŸ’¡ é…ç½®è¯´æ˜ï¼šåœ¨Cloudflareæ§åˆ¶å°åˆ›å»ºR2å­˜å‚¨æ¡¶ï¼Œå°†æ‚¨çš„åŸŸå img.yudong-textile.top é€šè¿‡CNAMEè®°å½•æŒ‡å‘R2å­˜å‚¨æ¡¶ã€‚
                                                    </p>
                                                </div>
                                            </div>
                                            
                                            <div class="data-backup-grid">
                                                <!-- æ•°æ®ä¸Šä¼ ä¸å¯¼å…¥ -->
                                                <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden">
                                                    <div class="bg-gray-50 p-4 border-b border-gray-200">
                                                        <h3 class="text-lg font-bold text-green-700">ğŸ“¤ æ•°æ®ä¸Šä¼ ä¸å¯¼å…¥</h3>
                                                    </div>
                                                    
                                                    <div class="p-4 space-y-4">
                                                        <div class="button-group">
                                                            <div>
                                                                <input 
                                                                    type="file" 
                                                                    id="localDbInput"
                                                                    @change="importDatabase"
                                                                    accept=".json,.zip"
                                                                    class="hidden"
                                                                >
                                                                <label 
                                                                    for="localDbInput"
                                                                    class="px-4 py-2 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition-colors cursor-pointer inline-block w-full text-center action-button no-tap-delay"
                                                                >
                                                                    ğŸ“‚ æœ¬åœ°DBå¯¼å…¥
                                                                </label>
                                                            </div>
                                                            
                                                            <button 
                                                                class="px-4 py-2 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition-colors action-button no-tap-delay"
                                                                @click="loadR2BackupFiles"
                                                            >
                                                                â˜ï¸ Cloudflare R2å¯¼å…¥
                                                            </button>
                                                        </div>
                                                        
                                                        <!-- R2å¤‡ä»½æ–‡ä»¶åˆ—è¡¨ -->
                                                        <div v-if="showBackupFiles" class="backup-file-list">
                                                            <div 
                                                                v-for="file in backupFiles" 
                                                                :key="file.Key"
                                                                class="backup-file-item no-tap-delay"
                                                                @click="importFromR2Backup(file.Key)"
                                                            >
                                                                <div class="font-semibold text-sm">{{ file.Key.replace('yudong-cloud/', '') }}</div>
                                                                <div class="text-xs text-gray-500">
                                                                    {{ formatBytes(file.Size) }} Â· {{ new Date(file.LastModified).toLocaleString('zh-CN') }}
                                                                </div>
                                                            </div>
                                                        </div>
                                                        
                                                        <div class="bg-yellow-50 border border-yellow-200 rounded p-3">
                                                            <p class="text-yellow-800">
                                                                å¯¼å…¥æ•°æ®åº“å°†è¦†ç›–å½“å‰æ‰€æœ‰äº§å“æ•°æ®ï¼Œè¯·è°¨æ…æ“ä½œã€‚
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <!-- å¤‡ä»½ä¸æ¸…ç©º -->
                                                <div class="bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden">
                                                    <div class="bg-gray-50 p-4 border-b border-gray-200">
                                                        <h3 class="text-lg font-bold text-green-700">ğŸ“¥ æ•°æ®å¤‡ä»½ä¸æ¸…ç©º</h3>
                                                    </div>
                                                    
                                                    <div class="p-4 space-y-4">
                                                        <div class="button-group">
                                                            <button 
                                                                class="px-4 py-2 bg-yellow-500 text-white rounded-lg font-semibold hover:bg-yellow-600 transition-colors action-button no-tap-delay"
                                                                @click="exportAndUploadBackup"
                                                            >
                                                                ZIP å¯¼å‡ºå®Œæ•´å¤‡ä»½
                                                            </button>
                                                            <button 
                                                                class="px-4 py-2 bg-red-500 text-white rounded-lg font-semibold hover:bg-red-600 transition-colors action-button no-tap-delay"
                                                                @click="clearData"
                                                            >
                                                                âš ï¸ æ¸…ç©ºæ‰€æœ‰æ•°æ®
                                                            </button>
                                                        </div>
                                                        
                                                        <div class="bg-red-50 border border-red-200 rounded p-3">
                                                            <p class="text-red-700">
                                                                å®Œæ•´å¤‡ä»½åŒ…å«æ•°æ®è¡¨å’Œæ‰€æœ‰å›¾ç‰‡ï¼Œå»ºè®®å®šæœŸå¯¼å‡ºã€‚
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- å›¾ç‰‡æ¨¡æ€æ¡† -->
                    <div v-if="imageModalVisible" class="fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 p-4">
                        <div class="bg-white rounded-lg max-w-4xl max-h-full overflow-auto relative">
                            <button 
                                class="absolute top-4 right-4 w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 transition-colors action-button no-tap-delay"
                                @click="closeImageModal"
                            >
                                âœ•
                            </button>
                            <img :src="currentImage" alt="äº§å“åº•å¡" class="max-w-full h-auto">
                        </div>
                    </div>
                </div>
                `
            });
            
            // æŒ‚è½½åº”ç”¨
            app.use(ElementPlus);
            app.mount('#app');
        });
    </script>
</body>
</html>